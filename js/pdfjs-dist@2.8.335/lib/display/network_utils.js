"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createResponseStatusError=createResponseStatusError,exports.extractFilenameFromHeader=extractFilenameFromHeader,exports.validateRangeRequestCapabilities=validateRangeRequestCapabilities,exports.validateResponseStatus=validateResponseStatus;var _util=require("../shared/util.js"),_content_disposition=require("./content_disposition.js"),_display_utils=require("./display_utils.js");function validateRangeRequestCapabilities(e){var t=e.getResponseHeader,s=e.isHttp,i=e.rangeChunkSize,n=e.disableRange;(0,_util.assert)(0<i,"Range chunk size must be larger than zero");var a={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(t("Content-Length"),10);return Number.isInteger(r)&&((a.suggestedLength=r)<=2*i||n||!s||"bytes"!==t("Accept-Ranges")||"identity"!==(t("Content-Encoding")||"identity")||(a.allowRangeRequests=!0)),a}function extractFilenameFromHeader(e){var t=e("Content-Disposition");if(t){var s=(0,_content_disposition.getFilenameFromContentDispositionHeader)(t);if(s.includes("%"))try{s=decodeURIComponent(s)}catch(e){}if((0,_display_utils.isPdfFile)(s))return s}return null}function createResponseStatusError(e,t){return 404===e||0===e&&t.startsWith("file:")?new _util.MissingPDFException('Missing PDF "'+t+'".'):new _util.UnexpectedResponseException("Unexpected server response (".concat(e,') while retrieving PDF "').concat(t,'".'),e)}function validateResponseStatus(e){return 200===e||206===e}