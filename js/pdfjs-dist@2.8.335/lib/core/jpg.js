"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var r=_toPrimitive(e,"string");return"symbol"===_typeof(r)?r:String(r)}function _toPrimitive(e,r){if("object"!==_typeof(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);var n=t.call(e,r||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _inherits(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&_setPrototypeOf(e,r)}function _setPrototypeOf(e,r){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}function _createSuper(n){var o=_isNativeReflectConstruct();return function(){var e,r=_getPrototypeOf(n);if(o){var t=_getPrototypeOf(this).constructor;e=Reflect.construct(r,arguments,t)}else e=r.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(e,r){if(r&&("object"===_typeof(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.JpegImage=void 0;var _util=require("../shared/util.js"),_core_utils=require("./core_utils.js"),JpegError=function(e){_inherits(t,_util.BaseException);var r=_createSuper(t);function t(e){return _classCallCheck(this,t),r.call(this,"JPEG error: ".concat(e))}return _createClass(t)}(),DNLMarkerError=function(e){_inherits(o,_util.BaseException);var n=_createSuper(o);function o(e,r){var t;return _classCallCheck(this,o),(t=n.call(this,e)).scanLines=r,t}return _createClass(o)}(),EOIMarkerError=function(e){_inherits(t,_util.BaseException);var r=_createSuper(t);function t(){return _classCallCheck(this,t),r.apply(this,arguments)}return _createClass(t)}(),JpegImage=function(){var K=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),P=4017,x=799,D=3406,E=2276,L=1567,T=3784,O=5793,I=2896;function e(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.decodeTransform,t=void 0===r?null:r,n=e.colorTransform,o=void 0===n?-1:n;this._decodeTransform=t,this._colorTransform=o}function Q(e,r){for(var t,n,o=0,a=[],i=16;0<i&&!e[i-1];)i--;a.push({children:[],index:0});var c,s=a[0];for(t=0;t<i;t++){for(n=0;n<e[t];n++){for((s=a.pop()).children[s.index]=r[o];0<s.index;)s=a.pop();for(s.index++,a.push(s);a.length<=t;)a.push(c={children:[],index:0}),s.children[s.index]=c.children,s=c;o++}t+1<i&&(a.push(c={children:[],index:0}),s.children[s.index]=c.children,s=c)}return a[0].children}function F(e,r,t){return 64*((e.blocksPerLine+1)*r+t)}function X(n,o,a,e,r,u,f,t,l){var i=9<arguments.length&&void 0!==arguments[9]&&arguments[9],c=a.mcusPerLine,s=a.progressive,h=o,p=0,d=0;function v(){if(0<d)return p>>--d&1;if(255===(p=n[o++])){var e=n[o++];if(e){if(220===e&&i){o+=2;var r=(0,_core_utils.readUint16)(n,o);if(o+=2,0<r&&r!==a.scanLines)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",r)}else if(217===e){if(i){var t=w*(8===a.precision?8:0);if(0<t&&10<=Math.round(a.scanLines/t))throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",t)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new JpegError("unexpected marker ".concat((p<<8|e).toString(16)))}}return p>>>(d=7)}function m(e){for(var r=e;;){switch(_typeof(r=r[v()])){case"number":return r;case"object":continue}throw new JpegError("invalid huffman sequence")}}function b(e){for(var r=0;0<e;)r=r<<1|v(),e--;return r}function _(e){if(1===e)return 1===v()?1:-1;var r=b(e);return 1<<e-1<=r?r:r+(-1<<e)+1}var g=0;var y,k=0;var w=0;function C(e,r,t,n,o){var a=t%c;w=(t/c|0)*e.v+n;var i=a*e.h+o;r(e,F(e,w,i))}function P(e,r,t){w=t/e.blocksPerLine|0;var n=t%e.blocksPerLine;r(e,F(e,w,n))}var x,D,E,L,T,O,I=e.length;O=s?0===u?0===t?function(e,r){var t=m(e.huffmanTableDC),n=0===t?0:_(t)<<l;e.blockData[r]=e.pred+=n}:function(e,r){e.blockData[r]|=v()<<l}:0===t?function(e,r){if(0<g)g--;else for(var t=u,n=f;t<=n;){var o=m(e.huffmanTableAC),a=15&o,i=o>>4;if(0!==a){var c=K[t+=i];e.blockData[r+c]=_(a)*(1<<l),t++}else{if(i<15){g=b(i)+(1<<i)-1;break}t+=16}}}:function(e,r){for(var t,n,o=u,a=f,i=0;o<=a;){var c=r+K[o],s=e.blockData[c]<0?-1:1;switch(k){case 0:if(i=(n=m(e.huffmanTableAC))>>4,0==(t=15&n))k=i<15?(g=b(i)+(1<<i),4):(i=16,1);else{if(1!==t)throw new JpegError("invalid ACn encoding");y=_(t),k=i?2:3}continue;case 1:case 2:e.blockData[c]?e.blockData[c]+=s*(v()<<l):0==--i&&(k=2===k?3:0);break;case 3:e.blockData[c]?e.blockData[c]+=s*(v()<<l):(e.blockData[c]=y<<l,k=0);break;case 4:e.blockData[c]&&(e.blockData[c]+=s*(v()<<l))}o++}4===k&&0==--g&&(k=0)}:function(e,r){var t=m(e.huffmanTableDC),n=0===t?0:_(t);e.blockData[r]=e.pred+=n;for(var o=1;o<64;){var a=m(e.huffmanTableAC),i=15&a,c=a>>4;if(0!==i){var s=K[o+=c];e.blockData[r+s]=_(i),o++}else{if(c<15)break;o+=16}}};var U,S,J,j,M=0;for(S=1===I?e[0].blocksPerLine*e[0].blocksPerColumn:c*a.mcusPerColumn;M<=S;){var R=r?Math.min(S-M,r):S;if(0<R){for(D=0;D<I;D++)e[D].pred=0;if(g=0,1===I)for(x=e[0],T=0;T<R;T++)P(x,O,M),M++;else for(T=0;T<R;T++){for(D=0;D<I;D++)for(J=(x=e[D]).h,j=x.v,E=0;E<j;E++)for(L=0;L<J;L++)C(x,O,M,E,L);M++}}if(d=0,!(U=Z(n,o)))break;if(U.invalid){var A=0<R?"unexpected":"excessive";(0,_util.warn)("decodeScan - ".concat(A," MCU data, current marker is: ").concat(U.invalid)),o=U.offset}if(!(65488<=U.marker&&U.marker<=65495))break;o+=2}return o-h}function c(e,r,t){var n,o,a,i,c,s,u,f,l,h,p,d,v,m,b,_,g,y=e.quantizationTable,k=e.blockData;if(!y)throw new JpegError("missing required Quantization Table.");for(var w=0;w<64;w+=8)l=k[r+w],h=k[r+w+1],p=k[r+w+2],d=k[r+w+3],v=k[r+w+4],m=k[r+w+5],b=k[r+w+6],_=k[r+w+7],l*=y[w],0!=(h|p|d|v|m|b|_)?(h*=y[w+1],p*=y[w+2],d*=y[w+3],v*=y[w+4],m*=y[w+5],b*=y[w+6],_*=y[w+7],o=(n=(n=O*l+128>>8)+(o=O*v+128>>8)+1>>1)-o,g=(a=p)*T+(i=b)*L+128>>8,a=a*L-i*T+128>>8,u=(c=(c=I*(h-_)+128>>8)+(u=m<<4)+1>>1)-u,s=(f=(f=I*(h+_)+128>>8)+(s=d<<4)+1>>1)-s,i=(n=n+(i=g)+1>>1)-i,a=(o=o+a+1>>1)-a,g=c*E+f*D+2048>>12,c=c*D-f*E+2048>>12,f=g,g=s*x+u*P+2048>>12,s=s*P-u*x+2048>>12,u=g,t[w]=n+f,t[w+7]=n-f,t[w+1]=o+u,t[w+6]=o-u,t[w+2]=a+s,t[w+5]=a-s,t[w+3]=i+c,t[w+4]=i-c):(g=O*l+512>>10,t[w]=g,t[w+1]=g,t[w+2]=g,t[w+3]=g,t[w+4]=g,t[w+5]=g,t[w+6]=g,t[w+7]=g);for(var C=0;C<8;++C)l=t[C],0!=((h=t[C+8])|(p=t[C+16])|(d=t[C+24])|(v=t[C+32])|(m=t[C+40])|(b=t[C+48])|(_=t[C+56]))?(o=(n=4112+((n=O*l+2048>>12)+(o=O*v+2048>>12)+1>>1))-o,g=(a=p)*T+(i=b)*L+2048>>12,a=a*L-i*T+2048>>12,i=g,u=(c=(c=I*(h-_)+2048>>12)+(u=m)+1>>1)-u,s=(f=(f=I*(h+_)+2048>>12)+(s=d)+1>>1)-s,g=c*E+f*D+2048>>12,c=c*D-f*E+2048>>12,f=g,g=s*x+u*P+2048>>12,s=s*P-u*x+2048>>12,(l=(n=n+i+1>>1)+f)<16?l=0:4080<=l?l=255:l>>=4,(h=(o=o+a+1>>1)+(u=g))<16?h=0:4080<=h?h=255:h>>=4,(p=(a=o-a)+s)<16?p=0:4080<=p?p=255:p>>=4,(d=(i=n-i)+c)<16?d=0:4080<=d?d=255:d>>=4,(v=i-c)<16?v=0:4080<=v?v=255:v>>=4,(m=a-s)<16?m=0:4080<=m?m=255:m>>=4,(b=o-u)<16?b=0:4080<=b?b=255:b>>=4,(_=n-f)<16?_=0:4080<=_?_=255:_>>=4,k[r+C]=l,k[r+C+8]=h,k[r+C+16]=p,k[r+C+24]=d,k[r+C+32]=v,k[r+C+40]=m,k[r+C+48]=b,k[r+C+56]=_):(g=(g=O*l+8192>>14)<-2040?0:2024<=g?255:g+2056>>4,k[r+C]=g,k[r+C+8]=g,k[r+C+16]=g,k[r+C+24]=g,k[r+C+32]=g,k[r+C+40]=g,k[r+C+48]=g,k[r+C+56]=g)}function W(e,r){for(var t=r.blocksPerLine,n=r.blocksPerColumn,o=new Int16Array(64),a=0;a<n;a++)for(var i=0;i<t;i++){c(r,F(r,a,i),o)}return r.blockData}function Z(e,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r,n=e.length-1,o=t<r?t:r;if(n<=r)return null;var a=(0,_core_utils.readUint16)(e,r);if(65472<=a&&a<=65534)return{invalid:null,marker:a,offset:r};for(var i=(0,_core_utils.readUint16)(e,o);!(65472<=i&&i<=65534);){if(++o>=n)return null;i=(0,_core_utils.readUint16)(e,o)}return{invalid:a.toString(16),marker:i,offset:o}}return e.prototype={parse:function(o){var e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).dnlScanLines,r=void 0===e?null:e;function t(){var e=(0,_core_utils.readUint16)(o,c),r=(c+=2)+e-2,t=Z(o,r,c);t&&t.invalid&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+t.invalid),r=t.offset);var n=o.subarray(c,r);return c+=n.length,n}function n(e){for(var r=Math.ceil(e.samplesPerLine/8/e.maxH),t=Math.ceil(e.scanLines/8/e.maxV),n=0;n<e.components.length;n++){M=e.components[n];var o=Math.ceil(Math.ceil(e.samplesPerLine/8)*M.h/e.maxH),a=Math.ceil(Math.ceil(e.scanLines/8)*M.v/e.maxV),i=r*M.h,c=64*(t*M.v)*(i+1);M.blockData=new Int16Array(c),M.blocksPerLine=o,M.blocksPerColumn=a}e.mcusPerLine=r,e.mcusPerColumn=t}var a,i,c=0,s=null,u=null,f=0,l=[],h=[],p=[],d=(0,_core_utils.readUint16)(o,c);if(c+=2,65496!==d)throw new JpegError("SOI not found");d=(0,_core_utils.readUint16)(o,c),c+=2;e:for(;65497!==d;){var v,m,b;switch(d){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var _=t();65504===d&&74===_[0]&&70===_[1]&&73===_[2]&&70===_[3]&&0===_[4]&&(s={version:{major:_[5],minor:_[6]},densityUnits:_[7],xDensity:_[8]<<8|_[9],yDensity:_[10]<<8|_[11],thumbWidth:_[12],thumbHeight:_[13],thumbData:_.subarray(14,14+3*_[12]*_[13])}),65518===d&&65===_[0]&&100===_[1]&&111===_[2]&&98===_[3]&&101===_[4]&&(u={version:_[5]<<8|_[6],flags0:_[7]<<8|_[8],flags1:_[9]<<8|_[10],transformCode:_[11]});break;case 65499:for(var g=(0,_core_utils.readUint16)(o,c)+(c+=2)-2;c<g;){var y=o[c++],k=new Uint16Array(64);if(y>>4==0)for(m=0;m<64;m++)k[K[m]]=o[c++];else{if(y>>4!=1)throw new JpegError("DQT - invalid table spec");for(m=0;m<64;m++)k[K[m]]=(0,_core_utils.readUint16)(o,c),c+=2}l[15&y]=k}break;case 65472:case 65473:case 65474:if(a)throw new JpegError("Only single frame JPEGs supported");c+=2,(a={}).extended=65473===d,a.progressive=65474===d,a.precision=o[c++];var w=(0,_core_utils.readUint16)(o,c);c+=2,a.scanLines=r||w,a.samplesPerLine=(0,_core_utils.readUint16)(o,c),c+=2,a.components=[],a.componentIds={};var C,P=o[c++],x=0,D=0;for(v=0;v<P;v++){C=o[c];var E=o[c+1]>>4,L=15&o[c+1];x<E&&(x=E),D<L&&(D=L);var T=o[c+2];b=a.components.push({h:E,v:L,quantizationId:T,quantizationTable:null}),a.componentIds[C]=b-1,c+=3}a.maxH=x,a.maxV=D,n(a);break;case 65476:var O=(0,_core_utils.readUint16)(o,c);for(c+=2,v=2;v<O;){var I=o[c++],U=new Uint8Array(16),S=0;for(m=0;m<16;m++,c++)S+=U[m]=o[c];var J=new Uint8Array(S);for(m=0;m<S;m++,c++)J[m]=o[c];v+=17+S,(I>>4==0?p:h)[15&I]=Q(U,J)}break;case 65501:c+=2,i=(0,_core_utils.readUint16)(o,c),c+=2;break;case 65498:var j=1==++f&&!r;c+=2;var M,R=o[c++],A=[];for(v=0;v<R;v++){var F=o[c++],N=a.componentIds[F];(M=a.components[N]).index=F;var z=o[c++];M.huffmanTableDC=p[z>>4],M.huffmanTableAC=h[15&z],A.push(M)}var q=o[c++],B=o[c++],Y=o[c++];try{var H=X(o,c,a,A,i,q,B,Y>>4,15&Y,j);c+=H}catch(e){if(e instanceof DNLMarkerError)return(0,_util.warn)("".concat(e.message," -- attempting to re-parse the JPEG image.")),this.parse(o,{dnlScanLines:e.scanLines});if(e instanceof EOIMarkerError){(0,_util.warn)("".concat(e.message," -- ignoring the rest of the image data."));break e}throw e}break;case 65500:c+=4;break;case 65535:255!==o[c]&&c--;break;default:var G=Z(o,c-2,c-3);if(G&&G.invalid){(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+G.invalid),c=G.offset;break}if(!G||c>=o.length-1){(0,_util.warn)("JpegImage.parse - reached the end of the image data without finding an EOI marker (0xFFD9).");break e}throw new JpegError("JpegImage.parse - unknown marker: "+d.toString(16))}d=(0,_core_utils.readUint16)(o,c),c+=2}for(this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=s,this.adobe=u,this.components=[],v=0;v<a.components.length;v++){var V=l[(M=a.components[v]).quantizationId];V&&(M.quantizationTable=V),this.components.push({index:M.index,output:W(0,M),scaleX:M.h/a.maxH,scaleY:M.v/a.maxV,blocksPerLine:M.blocksPerLine,blocksPerColumn:M.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(e,r){var t,n,o,a,i,c,s,u,f,l,h,p,d=2<arguments.length&&void 0!==arguments[2]&&arguments[2],v=this.width/e,m=this.height/r,b=0,_=this.components.length,g=e*r*_,y=new Uint8ClampedArray(g),k=new Uint32Array(e),w=4294967288;for(s=0;s<_;s++){if(n=(t=this.components[s]).scaleX*v,o=t.scaleY*m,b=s,h=t.output,a=t.blocksPerLine+1<<3,n!==p){for(i=0;i<e;i++)u=0|i*n,k[i]=(u&w)<<3|7&u;p=n}for(c=0;c<r;c++)for(l=a*((u=0|c*o)&w)|(7&u)<<3,i=0;i<e;i++)y[b]=h[l+k[i]],b+=_}var C=this._decodeTransform;if(d||4!==_||C||(C=new Int32Array([-256,255,-256,255,-256,255,-256,255])),C)for(s=0;s<g;)for(f=u=0;u<_;u++,s++,f+=2)y[s]=(y[s]*C[f]>>8)+C[f+1];return y},get _isColorConversionNeeded(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0!==this._colorTransform&&(82!==this.components[0].index||71!==this.components[1].index||66!==this.components[2].index):1===this._colorTransform},_convertYccToRgb:function(e){for(var r,t,n,o=0,a=e.length;o<a;o+=3)r=e[o],t=e[o+1],n=e[o+2],e[o]=r-179.456+1.402*n,e[o+1]=r+135.459-.344*t-.714*n,e[o+2]=r-226.816+1.772*t;return e},_convertYcckToRgb:function(e){for(var r,t,n,o,a=0,i=0,c=e.length;i<c;i+=4)r=e[i],t=e[i+1],n=e[i+2],o=e[i+3],e[a++]=t*(-660635669420364e-19*t+.000437130475926232*n-54080610064599e-18*r+.00048449797120281*o-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*r-.00477271405408747*o+1.53380253221734)+r*(.000961250184130688*r-.00266257332283933*o+.48357088451265)+o*(-.000336197177618394*o+.484791561490776),e[a++]=107.268039397724+t*(219927104525741e-19*t-.000640992018297945*n+.000659397001245577*r+.000426105652938837*o-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*r+.000770482631801132*o-.151051492775562)+r*(.00126935368114843*r-.00265090189010898*o+.25802910206845)+o*(-.000318913117588328*o-.213742400323665),e[a++]=t*(-.000570115196973677*t-263409051004589e-19*n+.0020741088115012*r-.00288260236853442*o+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*r+.000560833691242812*o-.195152027534049)+r*(.00174418132927582*r-.00255243321439347*o+.116935020465145)+o*(-.000343531996510555*o+.24165260232407);return e.subarray(0,a)},_convertYcckToCmyk:function(e){for(var r,t,n,o=0,a=e.length;o<a;o+=4)r=e[o],t=e[o+1],n=e[o+2],e[o]=434.456-r-1.402*n,e[o+1]=119.541-r+.344*t+.714*n,e[o+2]=481.816-r-1.772*t;return e},_convertCmykToRgb:function(e){for(var r,t,n,o,a=0,i=0,c=e.length;i<c;i+=4)r=e[i],t=e[i+1],n=e[i+2],o=e[i+3],e[a++]=255+r*(-6747147073602441e-20*r+.0008379262121013727*t+.0002894718188643294*n+.003264231057537806*o-1.1185611867203937)+t*(26374107616089405e-21*t-8626949158638572e-20*n-.0002748769067499491*o-.02155688794978967)+n*(-3878099212869363e-20*n-.0003267808279485286*o+.0686742238595345)-o*(.0003361971776183937*o+.7430659151342254),e[a++]=255+r*(.00013596372813588848*r+.000924537132573585*t+.00010567359618683593*n+.0004791864687436512*o-.3109689587515875)+t*(-.00023545346108370344*t+.0002702845253534714*n+.0020200308977307156*o-.7488052167015494)+n*(6834815998235662e-20*n+.00015168452363460973*o-.09751927774728933)-o*(.0003189131175883281*o+.7364883807733168),e[a++]=255+r*(13598650411385307e-21*r+.00012423956175490851*t+.0004751985097583589*n-36729317476630422e-22*o-.05562186980264034)+t*(.00016141380598724676*t+.0009692239130725186*n+.0007782692450036253*o-.44015232367526463)+n*(5.068882914068769e-7*n+.0017778369011375071*o-.7591454649749609)-o*(.0003435319965105553*o+.7063770186160144);return e.subarray(0,a)},getData:function(e){var r=e.width,t=e.height,n=e.forceRGB,o=void 0!==n&&n,a=e.isSourcePDF,i=void 0!==a&&a;if(4<this.numComponents)throw new JpegError("Unsupported color mode");var c=this._getLinearizedBlockData(r,t,i);if(1===this.numComponents&&o){for(var s=c.length,u=new Uint8ClampedArray(3*s),f=0,l=0;l<s;l++){var h=c[l];u[f++]=h,u[f++]=h,u[f++]=h}return u}if(3===this.numComponents&&this._isColorConversionNeeded)return this._convertYccToRgb(c);if(4===this.numComponents){if(this._isColorConversionNeeded)return o?this._convertYcckToRgb(c):this._convertYcckToCmyk(c);if(o)return this._convertCmykToRgb(c)}return c}},e}();exports.JpegImage=JpegImage;