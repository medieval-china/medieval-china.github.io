"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.StringStream=exports.StreamsSequenceStream=exports.Stream=exports.RunLengthStream=exports.PredictorStream=exports.NullStream=exports.LZWStream=exports.FlateStream=exports.DecryptStream=exports.DecodeStream=exports.AsciiHexStream=exports.Ascii85Stream=void 0;var _util=require("../shared/util.js"),_primitives=require("./primitives.js"),_core_utils=require("./core_utils.js"),Stream=function(){function i(t,e,r,i){this.bytes=t instanceof Uint8Array?t:new Uint8Array(t),this.start=e||0,this.pos=this.start,this.end=e+r||this.bytes.length,this.dict=i}return i.prototype={get length(){return this.end-this.start},get isEmpty(){return 0===this.length},getByte:function(){return this.pos>=this.end?-1:this.bytes[this.pos++]},getUint16:function(){var t=this.getByte(),e=this.getByte();return-1===t||-1===e?-1:(t<<8)+e},getInt32:function(){return(this.getByte()<<24)+(this.getByte()<<16)+(this.getByte()<<8)+this.getByte()},getBytes:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.bytes,i=this.pos,s=this.end;if(!t){var n=r.subarray(i,s);return e?new Uint8ClampedArray(n):n}var a=i+t;s<a&&(a=s),this.pos=a;var o=r.subarray(i,a);return e?new Uint8ClampedArray(o):o},peekByte:function(){var t=this.getByte();return-1!==t&&this.pos--,t},peekBytes:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.getBytes(t,e);return this.pos-=r.length,r},getByteRange:function(t,e){return t<0&&(t=0),e>this.end&&(e=this.end),this.bytes.subarray(t,e)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(t,e,r){return new i(this.bytes.buffer,t,e,r)}},i}();exports.Stream=Stream;var StringStream=function(){function t(t){var e=(0,_util.stringToBytes)(t);Stream.call(this,e)}return t.prototype=Stream.prototype,t}();exports.StringStream=StringStream;var DecodeStream=function(){var e=new Uint8Array(0);function t(t){if(this._rawMinBufferLength=t||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=e,this.minBufferLength=512,t)for(;this.minBufferLength<t;)this.minBufferLength*=2}return t.prototype={get length(){(0,_util.unreachable)("Should not access DecodeStream.length")},get isEmpty(){for(;!this.eof&&0===this.bufferLength;)this.readBlock();return 0===this.bufferLength},ensureBuffer:function(t){var e=this.buffer;if(t<=e.byteLength)return e;for(var r=this.minBufferLength;r<t;)r*=2;var i=new Uint8Array(r);return i.set(e),this.buffer=i},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]},getUint16:function(){var t=this.getByte(),e=this.getByte();return-1===t||-1===e?-1:(t<<8)+e},getInt32:function(){return(this.getByte()<<24)+(this.getByte()<<16)+(this.getByte()<<8)+this.getByte()},getBytes:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=this.pos;if(t){for(this.ensureBuffer(i+t),e=i+t;!this.eof&&this.bufferLength<e;)this.readBlock();var s=this.bufferLength;s<e&&(e=s)}else{for(;!this.eof;)this.readBlock();e=this.bufferLength}this.pos=e;var n=this.buffer.subarray(i,e);return!r||n instanceof Uint8ClampedArray?n:new Uint8ClampedArray(n)},peekByte:function(){var t=this.getByte();return-1!==t&&this.pos--,t},peekBytes:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.getBytes(t,e);return this.pos-=r.length,r},makeSubStream:function(t,e,r){if(void 0===e)for(;!this.eof;)this.readBlock();else for(var i=t+e;this.bufferLength<=i&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,e,r)},getByteRange:function(t,e){(0,_util.unreachable)("Should not call DecodeStream.getByteRange")},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0},getBaseStreams:function(){return this.str&&this.str.getBaseStreams?this.str.getBaseStreams():[]}},t}();exports.DecodeStream=DecodeStream;var StreamsSequenceStream=function(){function t(t){for(var e=0,r=0,i=(this.streams=t).length;r<i;r++){var s=t[r];e+=s instanceof DecodeStream?s._rawMinBufferLength:s.length}DecodeStream.call(this,e)}return(t.prototype=Object.create(DecodeStream.prototype)).readBlock=function(){var t=this.streams;if(0!==t.length){var e=t.shift().getBytes(),r=this.bufferLength,i=r+e.length;this.ensureBuffer(i).set(e,r),this.bufferLength=i}else this.eof=!0},t.prototype.getBaseStreams=function(){for(var t=[],e=0,r=this.streams.length;e<r;e++){var i=this.streams[e];i.getBaseStreams&&t.push.apply(t,_toConsumableArray(i.getBaseStreams()))}return t},t}();exports.StreamsSequenceStream=StreamsSequenceStream;var FlateStream=function(){var F=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),E=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),I=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),T=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],j=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function t(t,e){this.str=t,this.dict=t.dict;var r=t.getByte(),i=t.getByte();if(-1===r||-1===i)throw new _util.FormatError("Invalid header in flate stream: ".concat(r,", ").concat(i));if(8!=(15&r))throw new _util.FormatError("Unknown compression method in flate stream: ".concat(r,", ").concat(i));if(((r<<8)+i)%31!=0)throw new _util.FormatError("Bad FCHECK in flate stream: ".concat(r,", ").concat(i));if(32&i)throw new _util.FormatError("FDICT bit set in flate stream: ".concat(r,", ").concat(i));this.codeSize=0,this.codeBuf=0,DecodeStream.call(this,e)}return(t.prototype=Object.create(DecodeStream.prototype)).getBits=function(t){for(var e,r=this.str,i=this.codeSize,s=this.codeBuf;i<t;){if(-1===(e=r.getByte()))throw new _util.FormatError("Bad encoding in flate stream");s|=e<<i,i+=8}return e=s&(1<<t)-1,this.codeBuf=s>>t,this.codeSize=i-=t,e},t.prototype.getCode=function(t){for(var e,r=this.str,i=t[0],s=t[1],n=this.codeSize,a=this.codeBuf;n<s&&-1!==(e=r.getByte());)a|=e<<n,n+=8;var o=i[a&(1<<s)-1],h=o>>16,f=65535&o;if(h<1||n<h)throw new _util.FormatError("Bad encoding in flate stream");return this.codeBuf=a>>h,this.codeSize=n-h,f},t.prototype.generateHuffmanTable=function(t){var e,r=t.length,i=0;for(e=0;e<r;++e)t[e]>i&&(i=t[e]);for(var s=1<<i,n=new Int32Array(s),a=1,o=0,h=2;a<=i;++a,o<<=1,h<<=1)for(var f=0;f<r;++f)if(t[f]===a){var u=0,c=o;for(e=0;e<a;++e)u=u<<1|1&c,c>>=1;for(e=u;e<s;e+=h)n[e]=a<<16|f;++o}return[n,i]},t.prototype.readBlock=function(){var t,e,r=this.str,i=this.getBits(3);if(1&i&&(this.eof=!0),0!==(i>>=1)){var s,n;if(1===i)s=T,n=j;else{if(2!==i)throw new _util.FormatError("Unknown block type in flate stream");var a,o=this.getBits(5)+257,h=this.getBits(5)+1,f=this.getBits(4)+4,u=new Uint8Array(F.length);for(a=0;a<f;++a)u[F[a]]=this.getBits(3);var c=this.generateHuffmanTable(u);a=e=0;for(var l,g,y,d=o+h,p=new Uint8Array(d);a<d;){var m=this.getCode(c);if(16===m)l=2,g=3,y=e;else if(17===m)g=l=3,y=e=0;else{if(18!==m){p[a++]=e=m;continue}l=7,g=11,y=e=0}for(var B=this.getBits(l)+g;0<B--;)p[a++]=y}s=this.generateHuffmanTable(p.subarray(0,o)),n=this.generateHuffmanTable(p.subarray(o,d))}for(var v=(t=this.buffer)?t.length:0,S=this.bufferLength;;){var b=this.getCode(s);if(b<256)v<=S+1&&(v=(t=this.ensureBuffer(S+1)).length),t[S++]=b;else{if(256===b)return void(this.bufferLength=S);var w=(b=E[b-=257])>>16;0<w&&(w=this.getBits(w)),e=(65535&b)+w,b=this.getCode(n),0<(w=(b=I[b])>>16)&&(w=this.getBits(w));var L=(65535&b)+w;v<=S+e&&(v=(t=this.ensureBuffer(S+e)).length);for(var k=0;k<e;++k,++S)t[S]=t[S-L]}}}else{var A;if(-1===(A=r.getByte()))throw new _util.FormatError("Bad block header in flate stream");var _=A;if(-1===(A=r.getByte()))throw new _util.FormatError("Bad block header in flate stream");if(_|=A<<8,-1===(A=r.getByte()))throw new _util.FormatError("Bad block header in flate stream");var x=A;if(-1===(A=r.getByte()))throw new _util.FormatError("Bad block header in flate stream");if((x|=A<<8)!==(65535&~_)&&(0!==_||0!==x))throw new _util.FormatError("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;var C=this.bufferLength,D=C+_;if(t=this.ensureBuffer(D),this.bufferLength=D,0===_)-1===r.peekByte()&&(this.eof=!0);else{var U=r.getBytes(_);t.set(U,C),U.length<_&&(this.eof=!0)}}},t}();exports.FlateStream=FlateStream;var PredictorStream=function(){function t(t,e,r){if(!(0,_primitives.isDict)(r))return t;var i=this.predictor=r.get("Predictor")||1;if(i<=1)return t;if(2!==i&&(i<10||15<i))throw new _util.FormatError("Unsupported predictor: ".concat(i));this.readBlock=2===i?this.readBlockTiff:this.readBlockPng,this.str=t,this.dict=t.dict;var s=this.colors=r.get("Colors")||1,n=this.bits=r.get("BitsPerComponent")||8,a=this.columns=r.get("Columns")||1;return this.pixBytes=s*n+7>>3,this.rowBytes=a*s*n+7>>3,DecodeStream.call(this,e),this}return(t.prototype=Object.create(DecodeStream.prototype)).readBlockTiff=function(){var t=this.rowBytes,e=this.bufferLength,r=this.ensureBuffer(e+t),i=this.bits,s=this.colors,n=this.str.getBytes(t);if(this.eof=!n.length,!this.eof){var a,o=0,h=0,f=0,u=0,c=e;if(1===i&&1===s)for(a=0;a<t;++a){var l=n[a]^o;l^=l>>1,l^=l>>2,o=(1&(l^=l>>4))<<7,r[c++]=l}else if(8===i){for(a=0;a<s;++a)r[c++]=n[a];for(;a<t;++a)r[c]=r[c-s]+n[a],c++}else if(16===i){var g=2*s;for(a=0;a<g;++a)r[c++]=n[a];for(;a<t;a+=2){var y=((255&n[a])<<8)+(255&n[a+1])+((255&r[c-g])<<8)+(255&r[c-g+1]);r[c++]=y>>8&255,r[c++]=255&y}}else{var d=new Uint8Array(s+1),p=(1<<i)-1,m=0,B=e,v=this.columns;for(a=0;a<v;++a)for(var S=0;S<s;++S)f<i&&(o=o<<8|255&n[m++],f+=8),d[S]=d[S]+(o>>f-i)&p,f-=i,h=h<<i|d[S],8<=(u+=i)&&(r[B++]=h>>u-8&255,u-=8);0<u&&(r[B++]=(h<<8-u)+(o&(1<<8-u)-1))}this.bufferLength+=t}},t.prototype.readBlockPng=function(){var t=this.rowBytes,e=this.pixBytes,r=this.str.getByte(),i=this.str.getBytes(t);if(this.eof=!i.length,!this.eof){var s=this.bufferLength,n=this.ensureBuffer(s+t),a=n.subarray(s-t,s);0===a.length&&(a=new Uint8Array(t));var o,h,f,u=s;switch(r){case 0:for(o=0;o<t;++o)n[u++]=i[o];break;case 1:for(o=0;o<e;++o)n[u++]=i[o];for(;o<t;++o)n[u]=n[u-e]+i[o]&255,u++;break;case 2:for(o=0;o<t;++o)n[u++]=a[o]+i[o]&255;break;case 3:for(o=0;o<e;++o)n[u++]=(a[o]>>1)+i[o];for(;o<t;++o)n[u]=(a[o]+n[u-e]>>1)+i[o]&255,u++;break;case 4:for(o=0;o<e;++o)h=a[o],f=i[o],n[u++]=h+f;for(;o<t;++o){h=a[o];var c=a[o-e],l=n[u-e],g=l+h-c,y=g-l;y<0&&(y=-y);var d=g-h;d<0&&(d=-d);var p=g-c;p<0&&(p=-p),f=i[o],n[u++]=y<=d&&y<=p?l+f:d<=p?h+f:c+f}break;default:throw new _util.FormatError("Unsupported predictor: ".concat(r))}this.bufferLength+=t}},t}();exports.PredictorStream=PredictorStream;var DecryptStream=function(){function t(t,e,r){this.str=t,this.dict=t.dict,this.decrypt=r,this.nextChunk=null,this.initialized=!1,DecodeStream.call(this,e)}return(t.prototype=Object.create(DecodeStream.prototype)).readBlock=function(){var t;if(this.initialized?t=this.nextChunk:(t=this.str.getBytes(512),this.initialized=!0),t&&0!==t.length){this.nextChunk=this.str.getBytes(512);var e=this.nextChunk&&0<this.nextChunk.length;t=(0,this.decrypt)(t,!e);var r,i=this.bufferLength,s=t.length,n=this.ensureBuffer(i+s);for(r=0;r<s;r++)n[i++]=t[r];this.bufferLength=i}else this.eof=!0},t}();exports.DecryptStream=DecryptStream;var Ascii85Stream=function(){function t(t,e){this.str=t,this.dict=t.dict,this.input=new Uint8Array(5),e&&(e*=.8),DecodeStream.call(this,e)}return(t.prototype=Object.create(DecodeStream.prototype)).readBlock=function(){for(var t=this.str,e=t.getByte();(0,_core_utils.isWhiteSpace)(e);)e=t.getByte();if(-1!==e&&126!==e){var r,i,s=this.bufferLength;if(122===e){for(r=this.ensureBuffer(s+4),i=0;i<4;++i)r[s+i]=0;this.bufferLength+=4}else{var n=this.input;for(n[0]=e,i=1;i<5;++i){for(e=t.getByte();(0,_core_utils.isWhiteSpace)(e);)e=t.getByte();if(-1===(n[i]=e)||126===e)break}if(r=this.ensureBuffer(s+i-1),this.bufferLength+=i-1,i<5){for(;i<5;++i)n[i]=117;this.eof=!0}var a=0;for(i=0;i<5;++i)a=85*a+(n[i]-33);for(i=3;0<=i;--i)r[s+i]=255&a,a>>=8}}else this.eof=!0},t}();exports.Ascii85Stream=Ascii85Stream;var AsciiHexStream=function(){function t(t,e){this.str=t,this.dict=t.dict,this.firstDigit=-1,e&&(e*=.5),DecodeStream.call(this,e)}return(t.prototype=Object.create(DecodeStream.prototype)).readBlock=function(){var t=this.str.getBytes(8e3);if(t.length){for(var e=t.length+1>>1,r=this.ensureBuffer(this.bufferLength+e),i=this.bufferLength,s=this.firstDigit,n=0,a=t.length;n<a;n++){var o,h=t[n];if(48<=h&&h<=57)o=15&h;else{if(!(65<=h&&h<=70||97<=h&&h<=102)){if(62!==h)continue;this.eof=!0;break}o=9+(15&h)}s=s<0?o:(r[i++]=s<<4|o,-1)}0<=s&&this.eof&&(r[i++]=s<<4,s=-1),this.firstDigit=s,this.bufferLength=i}else this.eof=!0},t}();exports.AsciiHexStream=AsciiHexStream;var RunLengthStream=function(){function t(t,e){this.str=t,this.dict=t.dict,DecodeStream.call(this,e)}return(t.prototype=Object.create(DecodeStream.prototype)).readBlock=function(){var t=this.str.getBytes(2);if(!t||t.length<2||128===t[0])this.eof=!0;else{var e,r=this.bufferLength,i=t[0];if(i<128){if((e=this.ensureBuffer(r+i+1))[r++]=t[1],0<i){var s=this.str.getBytes(i);e.set(s,r),r+=i}}else{i=257-i;var n=t[1];e=this.ensureBuffer(r+i+1);for(var a=0;a<i;a++)e[r++]=n}this.bufferLength=r}},t}();exports.RunLengthStream=RunLengthStream;var LZWStream=function(){function t(t,e,r){this.str=t,this.dict=t.dict,this.cachedData=0,this.bitsCached=0;for(var i={earlyChange:r,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(4096),dictionaryLengths:new Uint16Array(4096),dictionaryPrevCodes:new Uint16Array(4096),currentSequence:new Uint8Array(4096),currentSequenceLength:0},s=0;s<256;++s)i.dictionaryValues[s]=s,i.dictionaryLengths[s]=1;this.lzwState=i,DecodeStream.call(this,e)}return(t.prototype=Object.create(DecodeStream.prototype)).readBits=function(t){for(var e=this.bitsCached,r=this.cachedData;e<t;){var i=this.str.getByte();if(-1===i)return this.eof=!0,null;r=r<<8|i,e+=8}return this.bitsCached=e-=t,this.cachedData=r,this.lastCode=null,r>>>e&(1<<t)-1},t.prototype.readBlock=function(){var t,e,r,i=1024,s=this.lzwState;if(s){var n=s.earlyChange,a=s.nextCode,o=s.dictionaryValues,h=s.dictionaryLengths,f=s.dictionaryPrevCodes,u=s.codeLength,c=s.prevCode,l=s.currentSequence,g=s.currentSequenceLength,y=0,d=this.bufferLength,p=this.ensureBuffer(this.bufferLength+i);for(t=0;t<512;t++){var m=this.readBits(u),B=0<g;if(m<256)l[0]=m,g=1;else{if(!(258<=m)){if(256===m){u=9,a=258,g=0;continue}this.eof=!0,delete this.lzwState;break}if(m<a)for(e=(g=h[m])-1,r=m;0<=e;e--)l[e]=o[r],r=f[r];else l[g++]=l[0]}if(B&&(f[a]=c,h[a]=h[c]+1,o[a]=l[0],u=++a+n&a+n-1?u:0|Math.min(Math.log(a+n)/.6931471805599453+1,12)),c=m,i<(y+=g)){for(;(i+=512)<y;);p=this.ensureBuffer(this.bufferLength+i)}for(e=0;e<g;e++)p[d++]=l[e]}s.nextCode=a,s.codeLength=u,s.prevCode=c,s.currentSequenceLength=g,this.bufferLength=d}},t}();exports.LZWStream=LZWStream;var NullStream=function(){function t(){Stream.call(this,new Uint8Array(0))}return t.prototype=Stream.prototype,t}();exports.NullStream=NullStream;