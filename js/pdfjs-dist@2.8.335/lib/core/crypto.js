"use strict";function _inherits(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&_setPrototypeOf(r,e)}function _setPrototypeOf(r,e){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,e){return r.__proto__=e,r})(r,e)}function _createSuper(n){var i=_isNativeReflectConstruct();return function(){var r,e=_getPrototypeOf(n);if(i){var t=_getPrototypeOf(this).constructor;r=Reflect.construct(e,arguments,t)}else r=e.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(r,e){if(e&&("object"===_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(r)}function _assertThisInitialized(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}function _getPrototypeOf(r){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}function _typeof(r){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,_toPropertyKey(n.key),n)}}function _createClass(r,e,t){return e&&_defineProperties(r.prototype,e),t&&_defineProperties(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function _toPropertyKey(r){var e=_toPrimitive(r,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(r,e){if("object"!==_typeof(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0===t)return("string"===e?String:Number)(r);var n=t.call(r,e||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.calculateSHA384=calculateSHA384,exports.PDF20=exports.PDF17=exports.CipherTransformFactory=exports.calculateSHA512=exports.calculateSHA256=exports.calculateMD5=exports.ARCFourCipher=exports.AES256Cipher=exports.AES128Cipher=void 0;var _util=require("../shared/util.js"),_primitives=require("./primitives.js"),_stream=require("./stream.js"),ARCFourCipher=function(){function a(r){_classCallCheck(this,a),this.a=0,this.b=0;var e,t,n=new Uint8Array(256),i=0,o=r.length;for(e=0;e<256;++e)n[e]=e;for(e=0;e<256;++e)i=i+(t=n[e])+r[e%o]&255,n[e]=n[i],n[i]=t;this.s=n}return _createClass(a,[{key:"encryptBlock",value:function(r){var e,t,n,i=r.length,o=this.a,a=this.b,s=this.s,h=new Uint8Array(i);for(e=0;e<i;++e)n=s[a=a+(t=s[o=o+1&255])&255],s[o]=n,s[a]=t,h[e]=r[e]^s[t+n&255];return this.a=o,this.b=a,h}},{key:"decryptBlock",value:function(r){return this.encryptBlock(r)}},{key:"encrypt",value:function(r){return this.encryptBlock(r)}}]),a}();exports.ARCFourCipher=ARCFourCipher;var calculateMD5=function(){var W=new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]),m=new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]);return function(r,e,t){var n,i,o,a=1732584193,s=-271733879,h=-1732584194,l=271733878,u=t+72&-64,c=new Uint8Array(u);for(n=0;n<t;++n)c[n]=r[e++];for(c[n++]=128,o=u-8;n<o;)c[n++]=0;c[n++]=t<<3&255,c[n++]=t>>5&255,c[n++]=t>>13&255,c[n++]=t>>21&255,c[n++]=t>>>29&255,c[n++]=0,c[n++]=0,c[n++]=0;var f=new Int32Array(16);for(n=0;n<u;){for(i=0;i<16;++i,n+=4)f[i]=c[n]|c[n+1]<<8|c[n+2]<<16|c[n+3]<<24;var y,w,d=a,g=s,p=h,v=l;for(i=0;i<64;++i){w=i<16?(y=g&p|~g&v,i):i<32?(y=v&g|~v&p,5*i+1&15):i<48?(y=g^p^v,3*i+5&15):(y=p^(g|~v),7*i&15);var _=v,C=d+y+m[i]+f[w]|0,A=W[i];v=p,g=(p=g)+(C<<A|C>>>32-A)|0,d=_}a=a+d|0,s=s+g|0,h=h+p|0,l=l+v|0}return new Uint8Array([255&a,a>>8&255,a>>16&255,a>>>24&255,255&s,s>>8&255,s>>16&255,s>>>24&255,255&h,h>>8&255,h>>16&255,h>>>24&255,255&l,l>>8&255,l>>16&255,l>>>24&255])}}();exports.calculateMD5=calculateMD5;var Word64=function(){function t(r,e){_classCallCheck(this,t),this.high=0|r,this.low=0|e}return _createClass(t,[{key:"and",value:function(r){this.high&=r.high,this.low&=r.low}},{key:"xor",value:function(r){this.high^=r.high,this.low^=r.low}},{key:"or",value:function(r){this.high|=r.high,this.low|=r.low}},{key:"shiftRight",value:function(r){32<=r?(this.low=this.high>>>r-32|0,this.high=0):(this.low=this.low>>>r|this.high<<32-r,this.high=this.high>>>r|0)}},{key:"shiftLeft",value:function(r){32<=r?(this.high=this.low<<r-32,this.low=0):(this.high=this.high<<r|this.low>>>32-r,this.low=this.low<<r)}},{key:"rotateRight",value:function(r){var e,t;32&r?(t=this.low,e=this.high):(e=this.low,t=this.high),r&=31,this.low=e>>>r|t<<32-r,this.high=t>>>r|e<<32-r}},{key:"not",value:function(){this.high=~this.high,this.low=~this.low}},{key:"add",value:function(r){var e=(this.low>>>0)+(r.low>>>0),t=(this.high>>>0)+(r.high>>>0);4294967295<e&&(t+=1),this.low=0|e,this.high=0|t}},{key:"copyTo",value:function(r,e){r[e]=this.high>>>24&255,r[e+1]=this.high>>16&255,r[e+2]=this.high>>8&255,r[e+3]=255&this.high,r[e+4]=this.low>>>24&255,r[e+5]=this.low>>16&255,r[e+6]=this.low>>8&255,r[e+7]=255&this.low}},{key:"assign",value:function(r){this.high=r.high,this.low=r.low}}]),t}(),calculateSHA256=function(){function O(r,e){return r>>>e|r<<32-e}var D=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];return function(r,e,t){var n,i,o,a=1779033703,s=3144134277,h=1013904242,l=2773480762,u=1359893119,c=2600822924,f=528734635,y=1541459225,w=64*Math.ceil((t+9)/64),d=new Uint8Array(w);for(n=0;n<t;++n)d[n]=r[e++];for(d[n++]=128,o=w-8;n<o;)d[n++]=0;d[n++]=0,d[n++]=0,d[n++]=0,d[n++]=t>>>29&255,d[n++]=t>>21&255,d[n++]=t>>13&255,d[n++]=t>>5&255,d[n++]=t<<3&255;var g,p,v,_,C,A,W,m,k=new Uint32Array(64);for(n=0;n<w;){for(i=0;i<16;++i)k[i]=d[n]<<24|d[n+1]<<16|d[n+2]<<8|d[n+3],n+=4;for(i=16;i<64;++i)k[i]=0|(O(m=k[i-2],17)^O(m,19)^m>>>10)+k[i-7]+(O(W=k[i-15],7)^O(W,18)^W>>>3)+k[i-16];var b,S,U=a,P=s,x=h,T=l,E=u,R=c,B=f,F=y;for(i=0;i<64;++i)b=F+(O(A=E,6)^O(A,11)^O(A,25))+((C=E)&R^~C&B)+D[i]+k[i],S=(O(_=U,2)^O(_,13)^O(_,22))+((g=U)&(p=P)^g&(v=x)^p&v),F=B,B=R,R=E,E=T+b|0,T=x,x=P,P=U,U=b+S|0;a=a+U|0,s=s+P|0,h=h+x|0,l=l+T|0,u=u+E|0,c=c+R|0,f=f+B|0,y=y+F|0}return new Uint8Array([a>>24&255,a>>16&255,a>>8&255,255&a,s>>24&255,s>>16&255,s>>8&255,255&s,h>>24&255,h>>16&255,h>>8&255,255&h,l>>24&255,l>>16&255,l>>8&255,255&l,u>>24&255,u>>16&255,u>>8&255,255&u,c>>24&255,c>>16&255,c>>8&255,255&c,f>>24&255,f>>16&255,f>>8&255,255&f,y>>24&255,y>>16&255,y>>8&255,255&y])}}();exports.calculateSHA256=calculateSHA256;var calculateSHA512=function(){var rr=[new Word64(1116352408,3609767458),new Word64(1899447441,602891725),new Word64(3049323471,3964484399),new Word64(3921009573,2173295548),new Word64(961987163,4081628472),new Word64(1508970993,3053834265),new Word64(2453635748,2937671579),new Word64(2870763221,3664609560),new Word64(3624381080,2734883394),new Word64(310598401,1164996542),new Word64(607225278,1323610764),new Word64(1426881987,3590304994),new Word64(1925078388,4068182383),new Word64(2162078206,991336113),new Word64(2614888103,633803317),new Word64(3248222580,3479774868),new Word64(3835390401,2666613458),new Word64(4022224774,944711139),new Word64(264347078,2341262773),new Word64(604807628,2007800933),new Word64(770255983,1495990901),new Word64(1249150122,1856431235),new Word64(1555081692,3175218132),new Word64(1996064986,2198950837),new Word64(2554220882,3999719339),new Word64(2821834349,766784016),new Word64(2952996808,2566594879),new Word64(3210313671,3203337956),new Word64(3336571891,1034457026),new Word64(3584528711,2466948901),new Word64(113926993,3758326383),new Word64(338241895,168717936),new Word64(666307205,1188179964),new Word64(773529912,1546045734),new Word64(1294757372,1522805485),new Word64(1396182291,2643833823),new Word64(1695183700,2343527390),new Word64(1986661051,1014477480),new Word64(2177026350,1206759142),new Word64(2456956037,344077627),new Word64(2730485921,1290863460),new Word64(2820302411,3158454273),new Word64(3259730800,3505952657),new Word64(3345764771,106217008),new Word64(3516065817,3606008344),new Word64(3600352804,1432725776),new Word64(4094571909,1467031594),new Word64(275423344,851169720),new Word64(430227734,3100823752),new Word64(506948616,1363258195),new Word64(659060556,3750685593),new Word64(883997877,3785050280),new Word64(958139571,3318307427),new Word64(1322822218,3812723403),new Word64(1537002063,2003034995),new Word64(1747873779,3602036899),new Word64(1955562222,1575990012),new Word64(2024104815,1125592928),new Word64(2227730452,2716904306),new Word64(2361852424,442776044),new Word64(2428436474,593698344),new Word64(2756734187,3733110249),new Word64(3204031479,2999351573),new Word64(3329325298,3815920427),new Word64(3391569614,3928383900),new Word64(3515267271,566280711),new Word64(3940187606,3454069534),new Word64(4118630271,4000239992),new Word64(116418474,1914138554),new Word64(174292421,2731055270),new Word64(289380356,3203993006),new Word64(460393269,320620315),new Word64(685471733,587496836),new Word64(852142971,1086792851),new Word64(1017036298,365543100),new Word64(1126000580,2618297676),new Word64(1288033470,3409855158),new Word64(1501505948,4234509866),new Word64(1607167915,987167468),new Word64(1816402316,1246189591)];return function(r,e,t){var n,i,o,a,s,h,l,u,c=3<arguments.length&&void 0!==arguments[3]&&arguments[3];u=c?(n=new Word64(3418070365,3238371032),i=new Word64(1654270250,914150663),o=new Word64(2438529370,812702999),a=new Word64(355462360,4144912697),s=new Word64(1731405415,4290775857),h=new Word64(2394180231,1750603025),l=new Word64(3675008525,1694076839),new Word64(1203062813,3204075428)):(n=new Word64(1779033703,4089235720),i=new Word64(3144134277,2227873595),o=new Word64(1013904242,4271175723),a=new Word64(2773480762,1595750129),s=new Word64(1359893119,2917565137),h=new Word64(2600822924,725511199),l=new Word64(528734635,4215389547),new Word64(1541459225,327033209));var f,y,w,d=128*Math.ceil((t+17)/128),g=new Uint8Array(d);for(f=0;f<t;++f)g[f]=r[e++];for(g[f++]=128,w=d-16;f<w;)g[f++]=0;g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=0,g[f++]=t>>>29&255,g[f++]=t>>21&255,g[f++]=t>>13&255,g[f++]=t>>5&255,g[f++]=t<<3&255;var p=new Array(80);for(f=0;f<80;f++)p[f]=new Word64(0,0);var v,_,C,A,W,m,k,b,S,U,P,x,T,E,R,B,F,O,D,M,H,K,j,N,I=new Word64(0,0),q=new Word64(0,0),z=new Word64(0,0),L=new Word64(0,0),V=new Word64(0,0),G=new Word64(0,0),J=new Word64(0,0),Q=new Word64(0,0),X=new Word64(0,0),Y=new Word64(0,0),Z=new Word64(0,0),$=new Word64(0,0);for(f=0;f<d;){for(y=0;y<16;++y)p[y].high=g[f]<<24|g[f+1]<<16|g[f+2]<<8|g[f+3],p[y].low=g[f+4]<<24|g[f+5]<<16|g[f+6]<<8|g[f+7],f+=8;for(y=16;y<80;++y)v=p[y],H=v,K=p[y-2],j=$,H.assign(K),H.rotateRight(19),j.assign(K),j.rotateRight(61),H.xor(j),j.assign(K),j.shiftRight(6),H.xor(j),v.add(p[y-7]),O=Z,D=p[y-15],M=$,O.assign(D),O.rotateRight(1),M.assign(D),M.rotateRight(8),O.xor(M),M.assign(D),M.shiftRight(7),O.xor(M),v.add(Z),v.add(p[y-16]);for(I.assign(n),q.assign(i),z.assign(o),L.assign(a),V.assign(s),G.assign(h),J.assign(l),Q.assign(u),y=0;y<80;++y)X.assign(Q),B=V,F=$,(R=Z).assign(B),R.rotateRight(14),F.assign(B),F.rotateRight(18),R.xor(F),F.assign(B),F.rotateRight(41),R.xor(F),X.add(Z),P=V,x=G,T=J,E=$,(U=Z).assign(P),U.and(x),E.assign(P),E.not(),E.and(T),U.xor(E),X.add(Z),X.add(rr[y]),X.add(p[y]),b=I,S=$,(k=Y).assign(b),k.rotateRight(28),S.assign(b),S.rotateRight(34),k.xor(S),S.assign(b),S.rotateRight(39),k.xor(S),C=I,A=q,W=z,m=$,(_=Z).assign(C),_.and(A),m.assign(C),m.and(W),_.xor(m),m.assign(A),m.and(W),_.xor(m),Y.add(Z),v=Q,Q=J,J=G,G=V,L.add(X),V=L,L=z,z=q,q=I,v.assign(X),v.add(Y),I=v;n.add(I),i.add(q),o.add(z),a.add(L),s.add(V),h.add(G),l.add(J),u.add(Q)}return c?(N=new Uint8Array(48),n.copyTo(N,0),i.copyTo(N,8),o.copyTo(N,16),a.copyTo(N,24),s.copyTo(N,32),h.copyTo(N,40)):(N=new Uint8Array(64),n.copyTo(N,0),i.copyTo(N,8),o.copyTo(N,16),a.copyTo(N,24),s.copyTo(N,32),h.copyTo(N,40),l.copyTo(N,48),u.copyTo(N,56)),N}}();function calculateSHA384(r,e,t){return calculateSHA512(r,e,t,!0)}exports.calculateSHA512=calculateSHA512;var NullCipher=function(){function r(){_classCallCheck(this,r)}return _createClass(r,[{key:"decryptBlock",value:function(r){return r}},{key:"encrypt",value:function(r){return r}}]),r}(),AESBaseCipher=function(){function e(){_classCallCheck(this,e),this.constructor===e&&(0,_util.unreachable)("Cannot initialize AESBaseCipher."),this._s=new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]),this._inv_s=new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]),this._mix=new Uint32Array([0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795]),this._mixCol=new Uint8Array(256);for(var r=0;r<256;r++)this._mixCol[r]=r<128?r<<1:r<<1^27;this.buffer=new Uint8Array(16),this.bufferPosition=0}return _createClass(e,[{key:"_expandKey",value:function(r){(0,_util.unreachable)("Cannot call `_expandKey` on the base class")}},{key:"_decrypt",value:function(r,e){var t,n,i,o=new Uint8Array(16);o.set(r);for(var a=0,s=this._keySize;a<16;++a,++s)o[a]^=e[s];for(var h=this._cyclesOfRepetition-1;1<=h;--h){t=o[13],o[13]=o[9],o[9]=o[5],o[5]=o[1],o[1]=t,t=o[14],n=o[10],o[14]=o[6],o[10]=o[2],o[6]=t,o[2]=n,t=o[15],n=o[11],i=o[7],o[15]=o[3],o[11]=t,o[7]=n,o[3]=i;for(var l=0;l<16;++l)o[l]=this._inv_s[o[l]];for(var u=0,c=16*h;u<16;++u,++c)o[u]^=e[c];for(var f=0;f<16;f+=4){var y=this._mix[o[f]],w=this._mix[o[f+1]],d=this._mix[o[f+2]],g=this._mix[o[f+3]];t=y^w>>>8^w<<24^d>>>16^d<<16^g>>>24^g<<8,o[f]=t>>>24&255,o[f+1]=t>>16&255,o[f+2]=t>>8&255,o[f+3]=255&t}}t=o[13],o[13]=o[9],o[9]=o[5],o[5]=o[1],o[1]=t,t=o[14],n=o[10],o[14]=o[6],o[10]=o[2],o[6]=t,o[2]=n,t=o[15],n=o[11],i=o[7],o[15]=o[3],o[11]=t,o[7]=n,o[3]=i;for(var p=0;p<16;++p)o[p]=this._inv_s[o[p]],o[p]^=e[p];return o}},{key:"_encrypt",value:function(r,e){var t,n,i,o=this._s,a=new Uint8Array(16);a.set(r);for(var s=0;s<16;++s)a[s]^=e[s];for(var h=1;h<this._cyclesOfRepetition;h++){for(var l=0;l<16;++l)a[l]=o[a[l]];i=a[1],a[1]=a[5],a[5]=a[9],a[9]=a[13],a[13]=i,i=a[2],n=a[6],a[2]=a[10],a[6]=a[14],a[10]=i,a[14]=n,i=a[3],n=a[7],t=a[11],a[3]=a[15],a[7]=i,a[11]=n,a[15]=t;for(var u=0;u<16;u+=4){var c=a[u+0],f=a[u+1],y=a[u+2],w=a[u+3];t=c^f^y^w,a[u+0]^=t^this._mixCol[c^f],a[u+1]^=t^this._mixCol[f^y],a[u+2]^=t^this._mixCol[y^w],a[u+3]^=t^this._mixCol[w^c]}for(var d=0,g=16*h;d<16;++d,++g)a[d]^=e[g]}for(var p=0;p<16;++p)a[p]=o[a[p]];i=a[1],a[1]=a[5],a[5]=a[9],a[9]=a[13],a[13]=i,i=a[2],n=a[6],a[2]=a[10],a[6]=a[14],a[10]=i,a[14]=n,i=a[3],n=a[7],t=a[11],a[3]=a[15],a[7]=i,a[11]=n,a[15]=t;for(var v=0,_=this._keySize;v<16;++v,++_)a[v]^=e[_];return a}},{key:"_decryptBlock2",value:function(r,e){for(var t=r.length,n=this.buffer,i=this.bufferPosition,o=[],a=this.iv,s=0;s<t;++s)if(n[i]=r[s],!(++i<16)){for(var h=this._decrypt(n,this._key),l=0;l<16;++l)h[l]^=a[l];a=n,o.push(h),n=new Uint8Array(16),i=0}if(this.buffer=n,this.bufferLength=i,this.iv=a,0===o.length)return new Uint8Array(0);var u=16*o.length;if(e){var c=o[o.length-1],f=c[15];if(f<=16){for(var y=15,w=16-f;w<=y;--y)if(c[y]!==f){f=0;break}u-=f,o[o.length-1]=c.subarray(0,16-f)}}for(var d=new Uint8Array(u),g=0,p=0,v=o.length;g<v;++g,p+=16)d.set(o[g],p);return d}},{key:"decryptBlock",value:function(r,e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=r.length,i=this.buffer,o=this.bufferPosition;if(t)this.iv=t;else{for(var a=0;o<16&&a<n;++a,++o)i[o]=r[a];if(o<16)return this.bufferLength=o,new Uint8Array(0);this.iv=i,r=r.subarray(16)}return this.buffer=new Uint8Array(16),this.bufferLength=0,this.decryptBlock=this._decryptBlock2,this.decryptBlock(r,e)}},{key:"encrypt",value:function(r,e){var t=r.length,n=this.buffer,i=this.bufferPosition,o=[];e||(e=new Uint8Array(16));for(var a=0;a<t;++a)if(n[i]=r[a],!(++i<16)){for(var s=0;s<16;++s)n[s]^=e[s];var h=this._encrypt(n,this._key);e=h,o.push(h),n=new Uint8Array(16),i=0}if(this.buffer=n,this.bufferLength=i,this.iv=e,0===o.length)return new Uint8Array(0);for(var l=16*o.length,u=new Uint8Array(l),c=0,f=0,y=o.length;c<y;++c,f+=16)u.set(o[c],f);return u}}]),e}(),AES128Cipher=function(r){_inherits(n,AESBaseCipher);var t=_createSuper(n);function n(r){var e;return _classCallCheck(this,n),(e=t.call(this))._cyclesOfRepetition=10,e._keySize=160,e._rcon=new Uint8Array([141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141]),e._key=e._expandKey(r),e}return _createClass(n,[{key:"_expandKey",value:function(r){var e=this._s,t=this._rcon,n=new Uint8Array(176);n.set(r);for(var i=16,o=1;i<176;++o){var a=n[i-3],s=n[i-2],h=n[i-1],l=n[i-4];a=e[a],s=e[s],h=e[h],l=e[l],a^=t[o];for(var u=0;u<4;++u)n[i]=a^=n[i-16],n[++i]=s^=n[i-16],n[++i]=h^=n[i-16],n[++i]=l^=n[i-16],i++}return n}}]),n}();exports.AES128Cipher=AES128Cipher;var AES256Cipher=function(r){_inherits(n,AESBaseCipher);var t=_createSuper(n);function n(r){var e;return _classCallCheck(this,n),(e=t.call(this))._cyclesOfRepetition=14,e._keySize=224,e._key=e._expandKey(r),e}return _createClass(n,[{key:"_expandKey",value:function(r){var e=this._s,t=new Uint8Array(240);t.set(r);for(var n,i,o,a,s=1,h=32,l=1;h<240;++l){h%32==16?(n=e[n],i=e[i],o=e[o],a=e[a]):h%32==0&&(n=t[h-3],i=t[h-2],o=t[h-1],a=t[h-4],n=e[n],i=e[i],o=e[o],a=e[a],n^=s,256<=(s<<=1)&&(s=255&(27^s)));for(var u=0;u<4;++u)t[h]=n^=t[h-32],t[++h]=i^=t[h-32],t[++h]=o^=t[h-32],t[++h]=a^=t[h-32],h++}return t}}]),n}();exports.AES256Cipher=AES256Cipher;var PDF17=function(){function r(){_classCallCheck(this,r)}return _createClass(r,[{key:"checkOwnerPassword",value:function(r,e,t,n){var i=new Uint8Array(r.length+56);i.set(r,0),i.set(e,r.length),i.set(t,r.length+e.length);var o=calculateSHA256(i,0,i.length);return(0,_util.isArrayEqual)(o,n)}},{key:"checkUserPassword",value:function(r,e,t){var n=new Uint8Array(r.length+8);n.set(r,0),n.set(e,r.length);var i=calculateSHA256(n,0,n.length);return(0,_util.isArrayEqual)(i,t)}},{key:"getOwnerKey",value:function(r,e,t,n){var i=new Uint8Array(r.length+56);i.set(r,0),i.set(e,r.length),i.set(t,r.length+e.length);var o=calculateSHA256(i,0,i.length);return new AES256Cipher(o).decryptBlock(n,!1,new Uint8Array(16))}},{key:"getUserKey",value:function(r,e,t){var n=new Uint8Array(r.length+8);n.set(r,0),n.set(e,r.length);var i=calculateSHA256(n,0,n.length);return new AES256Cipher(i).decryptBlock(t,!1,new Uint8Array(16))}}]),r}();exports.PDF17=PDF17;var PDF20=function(){function a(r,e,t){for(var n=calculateSHA256(e,0,e.length).subarray(0,32),i=[0],o=0;o<64||i[i.length-1]>o-32;){var a=r.length+n.length+t.length,s=new Uint8Array(a),h=0;s.set(r,h),h+=r.length,s.set(n,h),h+=n.length,s.set(t,h);for(var l=new Uint8Array(64*a),u=0,c=0;u<64;u++,c+=a)l.set(s,c);i=new AES128Cipher(n.subarray(0,16)).encrypt(l,n.subarray(16,32));for(var f=0,y=0;y<16;y++)f*=1,f%=3,f+=(i[y]>>>0)%3,f%=3;0===f?n=calculateSHA256(i,0,i.length):1===f?n=calculateSHA384(i,0,i.length):2===f&&(n=calculateSHA512(i,0,i.length)),o++}return n.subarray(0,32)}return function(){function r(){_classCallCheck(this,r)}return _createClass(r,[{key:"hash",value:function(r,e,t){return a(r,e,t)}},{key:"checkOwnerPassword",value:function(r,e,t,n){var i=new Uint8Array(r.length+56);i.set(r,0),i.set(e,r.length),i.set(t,r.length+e.length);var o=a(r,i,t);return(0,_util.isArrayEqual)(o,n)}},{key:"checkUserPassword",value:function(r,e,t){var n=new Uint8Array(r.length+8);n.set(r,0),n.set(e,r.length);var i=a(r,n,[]);return(0,_util.isArrayEqual)(i,t)}},{key:"getOwnerKey",value:function(r,e,t,n){var i=new Uint8Array(r.length+56);i.set(r,0),i.set(e,r.length),i.set(t,r.length+e.length);var o=a(r,i,t);return new AES256Cipher(o).decryptBlock(n,!1,new Uint8Array(16))}},{key:"getUserKey",value:function(r,e,t){var n=new Uint8Array(r.length+8);n.set(r,0),n.set(e,r.length);var i=a(r,n,[]);return new AES256Cipher(i).decryptBlock(t,!1,new Uint8Array(16))}}]),r}()}();exports.PDF20=PDF20;var CipherTransform=function(){function t(r,e){_classCallCheck(this,t),this.StringCipherConstructor=r,this.StreamCipherConstructor=e}return _createClass(t,[{key:"createStream",value:function(r,e){var t=new this.StreamCipherConstructor;return new _stream.DecryptStream(r,e,function(r,e){return t.decryptBlock(r,e)})}},{key:"decryptString",value:function(r){var e=new this.StringCipherConstructor,t=(0,_util.stringToBytes)(r);return t=e.decryptBlock(t,!0),(0,_util.bytesToString)(t)}},{key:"encryptString",value:function(r){var e=new this.StringCipherConstructor;if(e instanceof AESBaseCipher){var t=r.length,n=16-t%16;16!==n&&(r=r.padEnd(16*Math.ceil(t/16),String.fromCharCode(n)));var i=new Uint8Array(16);if("undefined"!=typeof crypto)crypto.getRandomValues(i);else for(var o=0;o<16;o++)i[o]=Math.floor(256*Math.random());var a=(0,_util.stringToBytes)(r);a=e.encrypt(a,i);var s=new Uint8Array(16+a.length);return s.set(i),s.set(a,16),(0,_util.bytesToString)(s)}var h=(0,_util.stringToBytes)(r);return h=e.encrypt(h),(0,_util.bytesToString)(h)}}]),t}(),CipherTransformFactory=function(){var S=new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]);function U(r,e,t,n,i,o,a,s){var h,l,u=40+t.length+r.length,c=new Uint8Array(u),f=0;if(e)for(l=Math.min(32,e.length);f<l;++f)c[f]=e[f];for(h=0;f<32;)c[f++]=S[h++];for(h=0,l=t.length;h<l;++h)c[f++]=t[h];for(c[f++]=255&i,c[f++]=i>>8&255,c[f++]=i>>16&255,c[f++]=i>>>24&255,h=0,l=r.length;h<l;++h)c[f++]=r[h];4<=o&&!s&&(c[f++]=255,c[f++]=255,c[f++]=255,c[f++]=255);var y=calculateMD5(c,0,f),w=a>>3;if(3<=o)for(h=0;h<50;++h)y=calculateMD5(y,0,w);var d,g=y.subarray(0,w);if(3<=o){for(f=0;f<32;++f)c[f]=S[f];for(h=0,l=r.length;h<l;++h)c[f++]=r[h];d=new ARCFourCipher(g).encryptBlock(calculateMD5(c,0,f)),l=g.length;var p,v=new Uint8Array(l);for(h=1;h<=19;++h){for(p=0;p<l;++p)v[p]=g[p]^h;d=new ARCFourCipher(v).encryptBlock(d)}for(h=0,l=d.length;h<l;++h)if(n[h]!==d[h])return null}else for(h=0,l=(d=new ARCFourCipher(g).encryptBlock(S)).length;h<l;++h)if(n[h]!==d[h])return null;return g}var P=_primitives.Name.get("Identity");function s(r,e,t){var n,i,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=new Uint8Array(t.length+9);for(n=0,i=t.length;n<i;++n)a[n]=t[n];return a[n++]=255&r,a[n++]=r>>8&255,a[n++]=r>>16&255,a[n++]=255&e,a[n++]=e>>8&255,o&&(a[n++]=115,a[n++]=65,a[n++]=108,a[n++]=84),calculateMD5(a,0,n).subarray(0,Math.min(t.length+5,16))}function i(r,e,t,n,i){if(!(0,_primitives.isName)(e))throw new _util.FormatError("Invalid crypt filter name.");var o,a=r.get(e.name);if(null!=a&&(o=a.get("CFM")),!o||"None"===o.name)return function(){return new NullCipher};if("V2"===o.name)return function(){return new ARCFourCipher(s(t,n,i,!1))};if("AESV2"===o.name)return function(){return new AES128Cipher(s(t,n,i,!0))};if("AESV3"===o.name)return function(){return new AES256Cipher(i)};throw new _util.FormatError("Unknown crypto method")}return function(){function b(r,e,t){_classCallCheck(this,b);var n=r.get("Filter");if(!(0,_primitives.isName)(n,"Standard"))throw new _util.FormatError("unknown encryption method");var i=(this.dict=r).get("V");if(!Number.isInteger(i)||1!==i&&2!==i&&4!==i&&5!==i)throw new _util.FormatError("unsupported encryption algorithm");this.algorithm=i;var o=r.get("Length");if(!o)if(i<=3)o=40;else{var a=r.get("CF"),s=r.get("StmF");if((0,_primitives.isDict)(a)&&(0,_primitives.isName)(s)){a.suppressEncryption=!0;var h=a.get(s.name);(o=h&&h.get("Length")||128)<40&&(o<<=3)}}if(!Number.isInteger(o)||o<40||o%8!=0)throw new _util.FormatError("invalid key length");var l=(0,_util.stringToBytes)(r.get("O")).subarray(0,32),u=(0,_util.stringToBytes)(r.get("U")).subarray(0,32),c=r.get("P"),f=r.get("R"),y=(4===i||5===i)&&!1!==r.get("EncryptMetadata");this.encryptMetadata=y;var w,d,g=(0,_util.stringToBytes)(e);if(t){if(6===f)try{t=(0,_util.utf8StringToString)(t)}catch(r){(0,_util.warn)("CipherTransformFactory: Unable to convert UTF8 encoded password.")}w=(0,_util.stringToBytes)(t)}if(5!==i)d=U(g,w,l,u,c,f,o,y);else{var p=(0,_util.stringToBytes)(r.get("O")).subarray(32,40),v=(0,_util.stringToBytes)(r.get("O")).subarray(40,48),_=(0,_util.stringToBytes)(r.get("U")).subarray(0,48),C=(0,_util.stringToBytes)(r.get("U")).subarray(32,40),A=(0,_util.stringToBytes)(r.get("U")).subarray(40,48),W=(0,_util.stringToBytes)(r.get("OE")),m=(0,_util.stringToBytes)(r.get("UE"));(0,_util.stringToBytes)(r.get("Perms"));d=function(r,e,t,n,i,o,a,s,h,l,u,c){if(e){var f=Math.min(127,e.length);e=e.subarray(0,f)}else e=[];var y;return(y=6===r?new PDF20:new PDF17).checkUserPassword(e,s,a)?y.getUserKey(e,h,u):e.length&&y.checkOwnerPassword(e,n,o,t)?y.getOwnerKey(e,i,o,l):null}(f,w,l,p,v,_,u,C,A,W,m)}if(!d&&!t)throw new _util.PasswordException("No password given",_util.PasswordResponses.NEED_PASSWORD);if(!d&&t&&(d=U(g,function(r,e,t,n){var i,o,a=new Uint8Array(32),s=0;for(o=Math.min(32,r.length);s<o;++s)a[s]=r[s];for(i=0;s<32;)a[s++]=S[i++];var h,l=calculateMD5(a,0,s),u=n>>3;if(3<=t)for(i=0;i<50;++i)l=calculateMD5(l,0,l.length);if(3<=t){h=e;var c,f=new Uint8Array(u);for(i=19;0<=i;i--){for(c=0;c<u;++c)f[c]=l[c]^i;h=new ARCFourCipher(f).encryptBlock(h)}}else h=new ARCFourCipher(l.subarray(0,u)).encryptBlock(e);return h}(w,l,f,o),l,u,c,f,o,y)),!d)throw new _util.PasswordException("Incorrect Password",_util.PasswordResponses.INCORRECT_PASSWORD);if(this.encryptionKey=d,4<=i){var k=r.get("CF");(0,_primitives.isDict)(k)&&(k.suppressEncryption=!0),this.cf=k,this.stmf=r.get("StmF")||P,this.strf=r.get("StrF")||P,this.eff=r.get("EFF")||this.stmf}}return _createClass(b,[{key:"createCipherTransform",value:function(r,e){if(4===this.algorithm||5===this.algorithm)return new CipherTransform(i(this.cf,this.stmf,r,e,this.encryptionKey),i(this.cf,this.strf,r,e,this.encryptionKey));var t=s(r,e,this.encryptionKey,!1),n=function(){return new ARCFourCipher(t)};return new CipherTransform(n,n)}}]),b}()}();exports.CipherTransformFactory=CipherTransformFactory;