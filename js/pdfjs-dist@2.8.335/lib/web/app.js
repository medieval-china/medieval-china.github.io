"use strict";function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,p=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){p=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(p)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return a};var a={},e=Object.prototype,c=e.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",r=t.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var o,a,s,l,i=t&&t.prototype instanceof w?t:w,p=Object.create(i.prototype),c=new F(r||[]);return u(p,"_invoke",{value:(o=e,a=n,s=c,l="suspendedStart",function(e,t){if("executing"===l)throw new Error("Generator is already running");if("completed"===l){if("throw"===e)throw t;return A()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){var r=P(n,s);if(r){if(r===f)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===l)throw l="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);l="executing";var i=d(o,a,s);if("normal"===i.type){if(l=s.done?"completed":"suspendedYield",i.arg===f)continue;return{value:i.arg,done:s.done}}"throw"===i.type&&(l="completed",s.method="throw",s.arg=i.arg)}})}),p}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var f={};function w(){}function l(){}function p(){}var h={};o(h,i,function(){return this});var g=Object.getPrototypeOf,_=g&&g(g(D([])));_&&_!==e&&c.call(_,i)&&(h=_);var b=p.prototype=w.prototype=Object.create(h);function m(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function v(l,p){var t;u(this,"_invoke",{value:function(n,r){function e(){return new p(function(e,t){!function t(e,n,r,i){var o=d(l[e],l,n);if("throw"!==o.type){var a=o.arg,s=a.value;return s&&"object"==_typeof(s)&&c.call(s,"__await")?p.resolve(s.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):p.resolve(s).then(function(e){a.value=e,r(a)},function(e){return t("throw",e,r,i)})}i(o.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}})}function P(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,P(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function V(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function y(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function F(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(V,this),this.reset(!0)}function D(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(c.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:A}}function A(){return{value:void 0,done:!0}}return u(b,"constructor",{value:l.prototype=p,configurable:!0}),u(p,"constructor",{value:l,configurable:!0}),l.displayName=o(p,r,"GeneratorFunction"),a.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,o(e,r,"GeneratorFunction")),e.prototype=Object.create(b),e},a.awrap=function(e){return{__await:e}},m(v.prototype),o(v.prototype,n,function(){return this}),a.AsyncIterator=v,a.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var o=new v(s(e,t,n,r),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},m(b),o(b,r,"Generator"),o(b,i,function(){return this}),o(b,"toString",function(){return"[object Generator]"}),a.keys=function(e){var n=Object(e),r=[];for(var t in n)r.push(t);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=D,F.prototype={constructor:F,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(y),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=c.call(i,"catchLoc"),s=c.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),y(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;y(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},a}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function _asyncToGenerator(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){asyncGeneratorStep(r,t,n,i,o,"next",e)}function o(e){asyncGeneratorStep(r,t,n,i,o,"throw",e)}i(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);var r=n.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFViewerApplication=exports.PDFPrintServiceFactory=exports.DefaultExternalServices=void 0;var _ui_utils=require("./ui_utils.js"),_app_options=require("./app_options.js"),_pdf=require("../pdf"),_pdf_cursor_tools=require("./pdf_cursor_tools.js"),_pdf_rendering_queue=require("./pdf_rendering_queue.js"),_overlay_manager=require("./overlay_manager.js"),_password_prompt=require("./password_prompt.js"),_pdf_attachment_viewer=require("./pdf_attachment_viewer.js"),_pdf_document_properties=require("./pdf_document_properties.js"),_pdf_find_bar=require("./pdf_find_bar.js"),_pdf_find_controller=require("./pdf_find_controller.js"),_pdf_history=require("./pdf_history.js"),_pdf_layer_viewer=require("./pdf_layer_viewer.js"),_pdf_link_service=require("./pdf_link_service.js"),_pdf_outline_viewer=require("./pdf_outline_viewer.js"),_pdf_presentation_mode=require("./pdf_presentation_mode.js"),_pdf_scripting_manager=require("./pdf_scripting_manager.js"),_pdf_sidebar=require("./pdf_sidebar.js"),_pdf_sidebar_resizer=require("./pdf_sidebar_resizer.js"),_pdf_thumbnail_viewer=require("./pdf_thumbnail_viewer.js"),_pdf_viewer=require("./pdf_viewer.js"),_secondary_toolbar=require("./secondary_toolbar.js"),_toolbar=require("./toolbar.js"),_viewer_compatibility=require("./viewer_compatibility.js"),_view_history=require("./view_history.js"),DEFAULT_SCALE_DELTA=1.1,DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT=5e3,FORCE_PAGES_LOADED_TIMEOUT=1e4,WHEEL_ZOOM_DISABLED_TIMEOUT=1e3,ENABLE_PERMISSIONS_CLASS="enablePermissions",ViewOnLoad={UNKNOWN:-1,PREVIOUS:0,INITIAL:1},ViewerCssTheme={AUTOMATIC:0,LIGHT:1,DARK:2},KNOWN_VERSIONS=["1.0","1.1","1.2","1.3","1.4","1.5","1.6","1.7","1.8","1.9","2.0","2.1","2.2","2.3"],KNOWN_GENERATORS=["acrobat distiller","acrobat pdfwriter","adobe livecycle","adobe pdf library","adobe photoshop","ghostscript","tcpdf","cairo","dvipdfm","dvips","pdftex","pdfkit","itext","prince","quarkxpress","mac os x","microsoft","openoffice","oracle","luradocument","pdf-xchange","antenna house","aspose.cells","fpdf"],DefaultExternalServices=function(){function e(){throw _classCallCheck(this,e),new Error("Cannot initialize DefaultExternalServices.")}var t;return _createClass(e,null,[{key:"updateFindControlState",value:function(e){}},{key:"updateFindMatchesCount",value:function(e){}},{key:"initPassiveLoading",value:function(e){}},{key:"fallback",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})},{key:"reportTelemetry",value:function(e){}},{key:"createDownloadManager",value:function(e){throw new Error("Not implemented: createDownloadManager")}},{key:"createPreferences",value:function(){throw new Error("Not implemented: createPreferences")}},{key:"createL10n",value:function(e){throw new Error("Not implemented: createL10n")}},{key:"createScripting",value:function(e){throw new Error("Not implemented: createScripting")}},{key:"supportsIntegratedFind",get:function(){return(0,_pdf.shadow)(this,"supportsIntegratedFind",!1)}},{key:"supportsDocumentFonts",get:function(){return(0,_pdf.shadow)(this,"supportsDocumentFonts",!0)}},{key:"supportedMouseWheelZoomModifierKeys",get:function(){return(0,_pdf.shadow)(this,"supportedMouseWheelZoomModifierKeys",{ctrlKey:!0,metaKey:!0})}},{key:"isInAutomation",get:function(){return(0,_pdf.shadow)(this,"isInAutomation",!1)}}]),e}();exports.DefaultExternalServices=DefaultExternalServices;var validateFileURL,PDFViewerApplication={initialBookmark:document.location.hash.substring(1),_initializedCapability:(0,_pdf.createPromiseCapability)(),fellback:!1,appConfig:null,pdfDocument:null,pdfLoadingTask:null,printService:null,pdfViewer:null,pdfThumbnailViewer:null,pdfRenderingQueue:null,pdfPresentationMode:null,pdfDocumentProperties:null,pdfLinkService:null,pdfHistory:null,pdfSidebar:null,pdfSidebarResizer:null,pdfOutlineViewer:null,pdfAttachmentViewer:null,pdfLayerViewer:null,pdfCursorTools:null,pdfScriptingManager:null,store:null,downloadManager:null,overlayManager:null,preferences:null,toolbar:null,secondaryToolbar:null,eventBus:null,l10n:null,isInitialViewSet:!1,downloadComplete:!1,isViewerEmbedded:window.parent!==window,url:"",baseUrl:"",externalServices:DefaultExternalServices,_boundEvents:Object.create(null),documentInfo:null,metadata:null,_contentDispositionFilename:null,_contentLength:null,triggerDelayedFallback:null,_saveInProgress:!1,_wheelUnusedTicks:0,_idleCallbacks:new Set,initialize:function(n){var r=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.preferences=r.externalServices.createPreferences(),r.appConfig=n,e.next=4,r._readPreferences();case 4:return e.next=6,r._parseHashParameters();case 6:return r._forceCssTheme(),e.next=9,r._initializeL10n();case 9:return r.isViewerEmbedded&&_app_options.AppOptions.get("externalLinkTarget")===_pdf.LinkTarget.NONE&&_app_options.AppOptions.set("externalLinkTarget",_pdf.LinkTarget.TOP),e.next=12,r._initializeViewerComponents();case 12:r.bindEvents(),r.bindWindowEvents(),t=n.appContainer||document.documentElement,r.l10n.translate(t).then(function(){r.eventBus.dispatch("localized",{source:r})}),r._initializedCapability.resolve();case 17:case"end":return e.stop()}},e)}))()},_readPreferences:function(){var t=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_app_options.AppOptions.get("disablePreferences"))return e.abrupt("return");e.next=2;break;case 2:return e.prev=2,e.t0=_app_options.AppOptions,e.next=6,t.preferences.getAll();case 6:e.t1=e.sent,e.t0.setAll.call(e.t0,e.t1),e.next=13;break;case 10:e.prev=10,e.t2=e.catch(2),console.error('_readPreferences: "'.concat(null===e.t2||void 0===e.t2?void 0:e.t2.message,'".'));case 13:case"end":return e.stop()}},e,null,[[2,10]])}))()},_parseHashParameters:function(){var o=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(_app_options.AppOptions.get("pdfBugEnabled")){e.next=2;break}return e.abrupt("return",void 0);case 2:if(t=document.location.hash.substring(1)){e.next=5;break}return e.abrupt("return",void 0);case 5:if(n=(0,_ui_utils.parseQueryString)(t),r=[],"disableworker"in n&&"true"===n.disableworker&&r.push(loadFakeWorker()),"disablerange"in n&&_app_options.AppOptions.set("disableRange","true"===n.disablerange),"disablestream"in n&&_app_options.AppOptions.set("disableStream","true"===n.disablestream),"disableautofetch"in n&&_app_options.AppOptions.set("disableAutoFetch","true"===n.disableautofetch),"disablefontface"in n&&_app_options.AppOptions.set("disableFontFace","true"===n.disablefontface),"disablehistory"in n&&_app_options.AppOptions.set("disableHistory","true"===n.disablehistory),"webgl"in n&&_app_options.AppOptions.set("enableWebGL","true"===n.webgl),"verbosity"in n&&_app_options.AppOptions.set("verbosity",0|n.verbosity),!("textlayer"in n)){e.next=23;break}e.t0=n.textlayer,e.next="off"===e.t0?18:"visible"===e.t0?20:"shadow"===e.t0?20:"hover"===e.t0?20:23;break;case 18:return _app_options.AppOptions.set("textLayerMode",_ui_utils.TextLayerMode.DISABLE),e.abrupt("break",23);case 20:return o.appConfig.viewerContainer.classList.add("textLayer-"+n.textlayer),e.abrupt("break",23);case 23:if("pdfbug"in n&&(_app_options.AppOptions.set("pdfBug",!0),_app_options.AppOptions.set("fontExtraProperties",!0),i=n.pdfbug.split(","),r.push(loadAndEnablePDFBug(i))),"locale"in n&&_app_options.AppOptions.set("locale",n.locale),0===r.length)return e.abrupt("return",void 0);e.next=27;break;case 27:return e.abrupt("return",Promise.all(r).catch(function(e){console.error('_parseHashParameters: "'.concat(e.message,'".'))}));case 28:case"end":return e.stop()}},e)}))()},_initializeL10n:function(){var n=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.l10n=n.externalServices.createL10n({locale:_app_options.AppOptions.get("locale")}),e.next=3,n.l10n.getDirection();case 3:t=e.sent,document.getElementsByTagName("html")[0].dir=t;case 5:case"end":return e.stop()}},e)}))()},_forceCssTheme:function(){var e=_app_options.AppOptions.get("viewerCssTheme");if(e!==ViewerCssTheme.AUTOMATIC&&Object.values(ViewerCssTheme).includes(e))try{for(var t=document.styleSheets[0],n=(null==t?void 0:t.cssRules)||[],r=0,i=n.length;r<i;r++){var o,a=n[r];if(a instanceof CSSMediaRule&&"(prefers-color-scheme: dark)"===(null===(o=a.media)||void 0===o?void 0:o[0])){if(e===ViewerCssTheme.LIGHT)return void t.deleteRule(r);var s=/^@media \(prefers-color-scheme: dark\) {\n\s*([\w\s-.,:;/\\{}()]+)\n}$/.exec(a.cssText);return void(null!=s&&s[1]&&(t.deleteRule(r),t.insertRule(s[1],r)))}}}catch(e){console.error('_forceCssTheme: "'.concat(null==e?void 0:e.message,'".'))}},_initializeViewerComponents:function(){var c=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i,o,a,s,l,p;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=c.appConfig,n=t.eventBus||new _ui_utils.EventBus({isInAutomation:c.externalServices.isInAutomation}),c.eventBus=n,c.overlayManager=new _overlay_manager.OverlayManager,(r=new _pdf_rendering_queue.PDFRenderingQueue).onIdle=c._cleanup.bind(c),c.pdfRenderingQueue=r,i=new _pdf_link_service.PDFLinkService({eventBus:n,externalLinkTarget:_app_options.AppOptions.get("externalLinkTarget"),externalLinkRel:_app_options.AppOptions.get("externalLinkRel"),ignoreDestinationZoom:_app_options.AppOptions.get("ignoreDestinationZoom")}),c.pdfLinkService=i,o=c.externalServices.createDownloadManager(),c.downloadManager=o,a=new _pdf_find_controller.PDFFindController({linkService:i,eventBus:n}),c.findController=a,s=new _pdf_scripting_manager.PDFScriptingManager({eventBus:n,sandboxBundleSrc:_app_options.AppOptions.get("sandboxBundleSrc"),scriptingFactory:c.externalServices,docPropertiesLookup:c._scriptingDocProperties.bind(c)}),c.pdfScriptingManager=s,l=t.mainContainer,p=t.viewerContainer,c.pdfViewer=new _pdf_viewer.PDFViewer({container:l,viewer:p,eventBus:n,renderingQueue:r,linkService:i,downloadManager:o,findController:a,scriptingManager:s,renderer:_app_options.AppOptions.get("renderer"),enableWebGL:_app_options.AppOptions.get("enableWebGL"),l10n:c.l10n,textLayerMode:_app_options.AppOptions.get("textLayerMode"),imageResourcesPath:_app_options.AppOptions.get("imageResourcesPath"),renderInteractiveForms:_app_options.AppOptions.get("renderInteractiveForms"),enablePrintAutoRotate:_app_options.AppOptions.get("enablePrintAutoRotate"),useOnlyCssZoom:_app_options.AppOptions.get("useOnlyCssZoom"),maxCanvasPixels:_app_options.AppOptions.get("maxCanvasPixels"),enableScripting:_app_options.AppOptions.get("enableScripting")}),r.setViewer(c.pdfViewer),i.setViewer(c.pdfViewer),s.setViewer(c.pdfViewer),c.pdfThumbnailViewer=new _pdf_thumbnail_viewer.PDFThumbnailViewer({container:t.sidebar.thumbnailView,eventBus:n,renderingQueue:r,linkService:i,l10n:c.l10n}),r.setThumbnailViewer(c.pdfThumbnailViewer),c.pdfHistory=new _pdf_history.PDFHistory({linkService:i,eventBus:n}),i.setHistory(c.pdfHistory),c.supportsIntegratedFind||(c.findBar=new _pdf_find_bar.PDFFindBar(t.findBar,n,c.l10n)),c.pdfDocumentProperties=new _pdf_document_properties.PDFDocumentProperties(t.documentProperties,c.overlayManager,n,c.l10n),c.pdfCursorTools=new _pdf_cursor_tools.PDFCursorTools({container:l,eventBus:n,cursorToolOnLoad:_app_options.AppOptions.get("cursorToolOnLoad")}),c.toolbar=new _toolbar.Toolbar(t.toolbar,n,c.l10n),c.secondaryToolbar=new _secondary_toolbar.SecondaryToolbar(t.secondaryToolbar,l,n),c.supportsFullscreen&&(c.pdfPresentationMode=new _pdf_presentation_mode.PDFPresentationMode({container:l,pdfViewer:c.pdfViewer,eventBus:n})),c.passwordPrompt=new _password_prompt.PasswordPrompt(t.passwordOverlay,c.overlayManager,c.l10n,c.isViewerEmbedded),c.pdfOutlineViewer=new _pdf_outline_viewer.PDFOutlineViewer({container:t.sidebar.outlineView,eventBus:n,linkService:i}),c.pdfAttachmentViewer=new _pdf_attachment_viewer.PDFAttachmentViewer({container:t.sidebar.attachmentsView,eventBus:n,downloadManager:o}),c.pdfLayerViewer=new _pdf_layer_viewer.PDFLayerViewer({container:t.sidebar.layersView,eventBus:n,l10n:c.l10n}),c.pdfSidebar=new _pdf_sidebar.PDFSidebar({elements:t.sidebar,pdfViewer:c.pdfViewer,pdfThumbnailViewer:c.pdfThumbnailViewer,eventBus:n,l10n:c.l10n}),c.pdfSidebar.onToggled=c.forceRendering.bind(c),c.pdfSidebarResizer=new _pdf_sidebar_resizer.PDFSidebarResizer(t.sidebarResizer,n,c.l10n);case 38:case"end":return e.stop()}},e)}))()},run:function(e){this.initialize(e).then(webViewerInitialized)},get initialized(){return this._initializedCapability.settled},get initializedPromise(){return this._initializedCapability.promise},zoomIn:function(e){if(!this.pdfViewer.isInPresentationMode){for(var t=this.pdfViewer.currentScale;t=(t*DEFAULT_SCALE_DELTA).toFixed(2),t=Math.ceil(10*t)/10,t=Math.min(_ui_utils.MAX_SCALE,t),0<--e&&t<_ui_utils.MAX_SCALE;);this.pdfViewer.currentScaleValue=t}},zoomOut:function(e){if(!this.pdfViewer.isInPresentationMode){for(var t=this.pdfViewer.currentScale;t=(t/DEFAULT_SCALE_DELTA).toFixed(2),t=Math.floor(10*t)/10,t=Math.max(_ui_utils.MIN_SCALE,t),0<--e&&t>_ui_utils.MIN_SCALE;);this.pdfViewer.currentScaleValue=t}},zoomReset:function(){this.pdfViewer.isInPresentationMode||(this.pdfViewer.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE)},get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0},get page(){return this.pdfViewer.currentPageNumber},set page(e){this.pdfViewer.currentPageNumber=e},get supportsPrinting(){return PDFPrintServiceFactory.instance.supportsPrinting},get supportsFullscreen(){var e=document.documentElement,t=!!(e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen);return!1!==document.fullscreenEnabled&&!1!==document.mozFullScreenEnabled&&!1!==document.webkitFullscreenEnabled||(t=!1),(0,_pdf.shadow)(this,"supportsFullscreen",t)},get supportsIntegratedFind(){return this.externalServices.supportsIntegratedFind},get supportsDocumentFonts(){return this.externalServices.supportsDocumentFonts},get loadingBar(){var e=new _ui_utils.ProgressBar("#loadingBar");return(0,_pdf.shadow)(this,"loadingBar",e)},get supportedMouseWheelZoomModifierKeys(){return this.externalServices.supportedMouseWheelZoomModifierKeys},initPassiveLoading:function(){throw new Error("Not implemented: initPassiveLoading")},setTitleUsingUrl:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";this.url=t,this.baseUrl=t.split("#")[0];var n=(0,_pdf.getPdfFilenameFromUrl)(t,"");if(!n)try{n=decodeURIComponent((0,_pdf.getFilenameFromUrl)(t))||t}catch(e){n=t}this.setTitle(n)},setTitle:function(e){this.isViewerEmbedded||(document.title=e)},get _docFilename(){return this._contentDispositionFilename||(0,_pdf.getPdfFilenameFromUrl)(this.url)},_cancelIdleCallbacks:function(){if(this._idleCallbacks.size){var e,t=_createForOfIteratorHelper(this._idleCallbacks);try{for(t.s();!(e=t.n()).done;){var n=e.value;window.cancelIdleCallback(n)}}catch(e){t.e(e)}finally{t.f()}this._idleCallbacks.clear()}},close:function(){var r=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r._unblockDocumentLoadEvent(),r.appConfig.errorWrapper.container.hidden=!0,r.pdfLoadingTask){e.next=5;break}return e.abrupt("return");case 5:if(0<(null===(t=r.pdfDocument)||void 0===t?void 0:t.annotationStorage.size)&&r._annotationStorageModified)return e.prev=6,e.next=9,r.save({sourceEventType:"save"});e.next=13;break;case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(6);case 13:return(n=[]).push(r.pdfLoadingTask.destroy()),r.pdfLoadingTask=null,r.pdfDocument&&(r.pdfDocument=null,r.pdfThumbnailViewer.setDocument(null),r.pdfViewer.setDocument(null),r.pdfLinkService.setDocument(null),r.pdfDocumentProperties.setDocument(null)),webViewerResetPermissions(),r.store=null,r.isInitialViewSet=!1,r.downloadComplete=!1,r.url="",r.baseUrl="",r.documentInfo=null,r.metadata=null,r._contentDispositionFilename=null,r._contentLength=null,r.triggerDelayedFallback=null,r._saveInProgress=!1,r._cancelIdleCallbacks(),n.push(r.pdfScriptingManager.destroyPromise),r.pdfSidebar.reset(),r.pdfOutlineViewer.reset(),r.pdfAttachmentViewer.reset(),r.pdfLayerViewer.reset(),r.pdfHistory&&r.pdfHistory.reset(),r.findBar&&r.findBar.reset(),r.toolbar.reset(),r.secondaryToolbar.reset(),"undefined"!=typeof PDFBug&&PDFBug.cleanup(),e.next=42,Promise.all(n);case 42:case"end":return e.stop()}},e,null,[[6,11]])}))()},open:function(p,c){var u=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i,o,a,s,l;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u.pdfLoadingTask)return e.next=3,u.close();e.next=3;break;case 3:for(n in t=_app_options.AppOptions.getAll(_app_options.OptionKind.WORKER))_pdf.GlobalWorkerOptions[n]=t[n];for(o in r=Object.create(null),"string"==typeof p?(u.setTitleUsingUrl(p),r.url=p):p&&"byteLength"in p?r.data=p:p.url&&p.originalUrl&&(u.setTitleUsingUrl(p.originalUrl),r.url=p.url),i=_app_options.AppOptions.getAll(_app_options.OptionKind.API))a=i[o],r[o]=a;if(c)for(s in c)r[s]=c[s];return l=(0,_pdf.getDocument)(r),(u.pdfLoadingTask=l).onPassword=function(e,t){u.pdfLinkService.externalLinkEnabled=!1,u.passwordPrompt.setUpdateCallback(e,t),u.passwordPrompt.open()},l.onProgress=function(e){var t=e.loaded,n=e.total;u.progress(t/n)},l.onUnsupportedFeature=u.fallback.bind(u),e.abrupt("return",l.promise.then(function(e){u.load(e)},function(t){if(l===u.pdfLoadingTask){var e="loading_error";return t instanceof _pdf.InvalidPDFException?e="invalid_file_error":t instanceof _pdf.MissingPDFException?e="missing_file_error":t instanceof _pdf.UnexpectedResponseException&&(e="unexpected_response_error"),u.l10n.get(e).then(function(e){throw u._documentError(e,{message:null==t?void 0:t.message}),t})}}));case 16:case"end":return e.stop()}},e)}))()},_ensureDownloadComplete:function(){if(!this.pdfDocument||!this.downloadComplete)throw new Error("PDF document not downloaded.")},download:function(){var l=arguments,p=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i,o,a,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<l.length&&void 0!==l[0]?l[0]:{},n=t.sourceEventType,r=void 0===n?"download":n,i=p.baseUrl,o=p._docFilename,e.prev=2,p._ensureDownloadComplete(),e.next=6,p.pdfDocument.getData();case 6:return a=e.sent,s=new Blob([a],{type:"application/pdf"}),e.next=10,p.downloadManager.download(s,i,o,r);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(2),e.next=16,p.downloadManager.downloadUrl(i,o);case 16:case"end":return e.stop()}},e,null,[[2,12]])}))()},save:function(){var l=arguments,p=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i,o,a,s;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<l.length&&void 0!==l[0]?l[0]:{},n=t.sourceEventType,r=void 0===n?"download":n,p._saveInProgress)return e.abrupt("return");e.next=3;break;case 3:return p._saveInProgress=!0,e.next=6,p.pdfScriptingManager.dispatchWillSave();case 6:return i=p.baseUrl,o=p._docFilename,e.prev=7,p._ensureDownloadComplete(),e.next=11,p.pdfDocument.saveDocument(p.pdfDocument.annotationStorage);case 11:return a=e.sent,s=new Blob([a],{type:"application/pdf"}),e.next=15,p.downloadManager.download(s,i,o,r);case 15:e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(7),e.next=21,p.download({sourceEventType:r});case 21:return e.prev=21,e.next=24,p.pdfScriptingManager.dispatchDidSave();case 24:return p._saveInProgress=!1,e.finish(21);case 26:case"end":return e.stop()}},e,null,[[7,17,21,26]])}))()},downloadOrSave:function(e){var t;0<(null===(t=this.pdfDocument)||void 0===t?void 0:t.annotationStorage.size)?this.save(e):this.download(e)},_delayedFallback:function(e){var t=this;this.externalServices.reportTelemetry({type:"unsupportedFeature",featureId:e}),this.triggerDelayedFallback||(this.triggerDelayedFallback=function(){t.fallback(e),t.triggerDelayedFallback=null})},fallback:function(e){var t=this;switch(this.externalServices.reportTelemetry({type:"unsupportedFeature",featureId:e}),e){case _pdf.UNSUPPORTED_FEATURES.errorFontLoadNative:case _pdf.UNSUPPORTED_FEATURES.errorFontMissing:return}this.fellback||(this.fellback=!0,this.externalServices.fallback({featureId:e,url:this.baseUrl}).then(function(e){e&&t.download({sourceEventType:"download"})}))},_documentError:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._unblockDocumentLoadEvent(),this._otherError(e,t)},_otherError:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=[this.l10n.get("error_version_info",{version:_pdf.version||"?",build:_pdf.build||"?"})];t&&(n.push(this.l10n.get("error_message",{message:t.message})),t.stack?n.push(this.l10n.get("error_stack",{stack:t.stack})):(t.filename&&n.push(this.l10n.get("error_file",{file:t.filename})),t.lineNumber&&n.push(this.l10n.get("error_line",{line:t.lineNumber}))));var r=this.appConfig.errorWrapper,i=r.container;i.hidden=!1,r.errorMessage.textContent=e;var o=r.closeButton;o.onclick=function(){i.hidden=!0};var a=r.errorMoreInfo,s=r.moreInfoButton,l=r.lessInfoButton;s.onclick=function(){a.hidden=!1,s.hidden=!0,l.hidden=!1,a.style.height=a.scrollHeight+"px"},l.onclick=function(){a.hidden=!0,s.hidden=!1,l.hidden=!0},s.oncontextmenu=_ui_utils.noContextMenuHandler,l.oncontextmenu=_ui_utils.noContextMenuHandler,o.oncontextmenu=_ui_utils.noContextMenuHandler,s.hidden=!1,l.hidden=!0,Promise.all(n).then(function(e){a.value=e.join("\n")})},progress:function(e){var t=this;if(!this.downloadComplete){var n=Math.round(100*e);if(n>this.loadingBar.percent||isNaN(n))this.loadingBar.percent=n,(this.pdfDocument?this.pdfDocument.loadingParams.disableAutoFetch:_app_options.AppOptions.get("disableAutoFetch"))&&n&&(this.disableAutoFetchLoadingBarTimeout&&(clearTimeout(this.disableAutoFetchLoadingBarTimeout),this.disableAutoFetchLoadingBarTimeout=null),this.loadingBar.show(),this.disableAutoFetchLoadingBarTimeout=setTimeout(function(){t.loadingBar.hide(),t.disableAutoFetchLoadingBarTimeout=null},DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT))}},load:function(h){var g=this;(this.pdfDocument=h).getDownloadInfo().then(function(e){var t=e.length;g._contentLength=t,g.downloadComplete=!0,g.loadingBar.hide(),i.then(function(){g.eventBus.dispatch("documentloaded",{source:g})})});var t=h.getPageLayout().catch(function(){}),n=h.getPageMode().catch(function(){}),r=h.getOpenAction().catch(function(){});this.toolbar.setPagesCount(h.numPages,!1),this.secondaryToolbar.setPagesCount(h.numPages),this.pdfLinkService.setDocument(h,null),this.pdfDocumentProperties.setDocument(h,this.url);var _=this.pdfViewer;_.setDocument(h);var i=_.firstPagePromise,e=_.onePageRendered,b=_.pagesPromise;this.pdfThumbnailViewer.setDocument(h);var o=(this.store=new _view_history.ViewHistory(h.fingerprint)).getMultiple({page:null,zoom:_ui_utils.DEFAULT_SCALE_VALUE,scrollLeft:"0",scrollTop:"0",rotation:null,sidebarView:_ui_utils.SidebarView.UNKNOWN,scrollMode:_ui_utils.ScrollMode.UNKNOWN,spreadMode:_ui_utils.SpreadMode.UNKNOWN}).catch(function(){return Object.create(null)});i.then(function(e){g.loadingBar.setWidth(g.appConfig.viewerContainer),g._initializeAnnotationStorageCallbacks(h),Promise.all([_ui_utils.animationStarted,o,t,n,r]).then(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark(function e(t){var n,r,i,o,a,s,l,p,c,u,d,f,w;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=_slicedToArray(t,5),n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=_app_options.AppOptions.get("viewOnLoad"),g._initializePdfHistory({fingerprint:h.fingerprint,viewOnLoad:s,initialDest:null==a?void 0:a.dest}),l=g.initialBookmark,p=_app_options.AppOptions.get("defaultZoomValue"),c=p?"zoom=".concat(p):null,u=null,d=_app_options.AppOptions.get("sidebarViewOnLoad"),f=_app_options.AppOptions.get("scrollModeOnLoad"),w=_app_options.AppOptions.get("spreadModeOnLoad"),r.page&&s!==ViewOnLoad.INITIAL&&(c="page=".concat(r.page,"&zoom=").concat(p||r.zoom,",")+"".concat(r.scrollLeft,",").concat(r.scrollTop),u=parseInt(r.rotation,10),d===_ui_utils.SidebarView.UNKNOWN&&(d=0|r.sidebarView),f===_ui_utils.ScrollMode.UNKNOWN&&(f=0|r.scrollMode),w===_ui_utils.SpreadMode.UNKNOWN&&(w=0|r.spreadMode)),o&&d===_ui_utils.SidebarView.UNKNOWN&&(d=(0,_ui_utils.apiPageModeToSidebarView)(o)),i&&w===_ui_utils.SpreadMode.UNKNOWN&&(w=(0,_ui_utils.apiPageLayoutToSpreadMode)(i)),g.setInitialView(c,{rotation:u,sidebarView:d,scrollMode:f,spreadMode:w}),g.eventBus.dispatch("documentinit",{source:g}),g.isViewerEmbedded||_.focus(),g._initializePermissions(h),e.next=19,Promise.race([b,new Promise(function(e){setTimeout(e,FORCE_PAGES_LOADED_TIMEOUT)})]);case 19:if(l||c){e.next=21;break}return e.abrupt("return");case 21:if(_.hasEqualPageSizes)return e.abrupt("return");e.next=23;break;case 23:g.initialBookmark=l,_.currentScaleValue=_.currentScaleValue,g.setInitialView(c);case 26:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()).catch(function(){g.setInitialView()}).then(function(){_.update()})}),b.then(function(){g._unblockDocumentLoadEvent(),g._initializeAutoPrint(h,r)}),e.then(function(){if(h.getOutline().then(function(e){g.pdfOutlineViewer.render({outline:e,pdfDocument:h})}),h.getAttachments().then(function(e){g.pdfAttachmentViewer.render({attachments:e})}),_.optionalContentConfigPromise.then(function(e){g.pdfLayerViewer.render({optionalContentConfig:e,pdfDocument:h})}),"requestIdleCallback"in window){var e=window.requestIdleCallback(function(){g._collectTelemetry(h),g._idleCallbacks.delete(e)},{timeout:1e3});g._idleCallbacks.add(e)}}),this._initializePageLabels(h),this._initializeMetadata(h)},_scriptingDocProperties:function(r){var i=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.documentInfo){e.next=5;break}return e.next=3,new Promise(function(e){i.eventBus._on("metadataloaded",e,{once:!0})});case 3:if(r!==i.pdfDocument)return e.abrupt("return",null);e.next=5;break;case 5:if(i._contentLength){e.next=10;break}return e.next=8,new Promise(function(e){i.eventBus._on("documentloaded",e,{once:!0})});case 8:if(r!==i.pdfDocument)return e.abrupt("return",null);e.next=10;break;case 10:return e.abrupt("return",_objectSpread(_objectSpread({},i.documentInfo),{},{baseURL:i.baseUrl,filesize:i._contentLength,filename:i._docFilename,metadata:null===(t=i.metadata)||void 0===t?void 0:t.getRaw(),authors:null===(n=i.metadata)||void 0===n?void 0:n.get("dc:creator"),numPages:i.pagesCount,URL:i.url}));case 11:case"end":return e.stop()}},e)}))()},_collectTelemetry:function(r){var i=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.pdfDocument.getMarkInfo();case 2:if(t=e.sent,r!==i.pdfDocument)return e.abrupt("return");e.next=5;break;case 5:n=(null==t?void 0:t.Marked)||!1,i.externalServices.reportTelemetry({type:"tagged",tagged:n});case 7:case"end":return e.stop()}},e)}))()},_initializeAutoPrint:function(p,c){var u=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i,o,a,s,l;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([c,u.pdfViewer.enableScripting?null:p.getJavaScript()]);case 2:if(t=e.sent,n=_slicedToArray(t,2),r=n[0],i=n[1],p!==u.pdfDocument)return e.abrupt("return");e.next=8;break;case 8:if(o=!1,"Print"===(null==r?void 0:r.action)&&(o=!0),!i){e.next=31;break}if(i.some(function(e){return!!e&&(console.warn("Warning: JavaScript is not supported"),u._delayedFallback(_pdf.UNSUPPORTED_FEATURES.javaScript),!0)}),o){e.next=31;break}a=_createForOfIteratorHelper(i),e.prev=14,a.s();case 16:if((s=a.n()).done){e.next=23;break}if((l=s.value)&&_ui_utils.AutoPrintRegExp.test(l))return o=!0,e.abrupt("break",23);e.next=21;break;case 21:e.next=16;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(14),a.e(e.t0);case 28:return e.prev=28,a.f(),e.finish(28);case 31:o&&u.triggerPrinting();case 32:case"end":return e.stop()}},e,null,[[14,25,28,31]])}))()},_initializeMetadata:function(w){var h=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i,o,a,s,l,p,c,u,d,f;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.getMetadata();case 2:if(r=e.sent,i=r.info,o=r.metadata,a=r.contentDispositionFilename,s=r.contentLength,w!==h.pdfDocument)return e.abrupt("return");e.next=9;break;case 9:h.documentInfo=i,h.metadata=o,null!==(t=h._contentDispositionFilename)&&void 0!==t||(h._contentDispositionFilename=a),null!==(n=h._contentLength)&&void 0!==n||(h._contentLength=s),console.log("PDF ".concat(w.fingerprint," [").concat(i.PDFFormatVersion," ")+"".concat((i.Producer||"-").trim()," / ").concat((i.Creator||"-").trim(),"] ")+"(PDF.js: ".concat(_pdf.version||"-")+"".concat(h.pdfViewer.enableWebGL?" [WebGL]":"",")")),l=null==i?void 0:i.Title,(p=null==o?void 0:o.get("dc:title"))&&("Untitled"===p||/[\uFFF0-\uFFFF]/g.test(p)||(l=p)),l?h.setTitle("".concat(l," - ").concat(a||document.title)):a&&h.setTitle(a),!i.IsXFAPresent||i.IsAcroFormPresent||w.isPureXfa?!i.IsAcroFormPresent&&!i.IsXFAPresent||h.pdfViewer.renderInteractiveForms||(console.warn("Warning: Interactive form support is not enabled"),h._delayedFallback(_pdf.UNSUPPORTED_FEATURES.forms)):(console.warn("Warning: XFA is not supported"),h._delayedFallback(_pdf.UNSUPPORTED_FEATURES.forms)),c="other",KNOWN_VERSIONS.includes(i.PDFFormatVersion)&&(c="v".concat(i.PDFFormatVersion.replace(".","_"))),u="other",i.Producer&&(d=i.Producer.toLowerCase(),KNOWN_GENERATORS.some(function(e){return!!d.includes(e)&&(u=e.replace(/[ .-]/g,"_"),!0)})),f=null,i.IsXFAPresent?f="xfa":i.IsAcroFormPresent&&(f="acroform"),h.externalServices.reportTelemetry({type:"documentInfo",version:c,generator:u,formType:f}),h.eventBus.dispatch("metadataloaded",{source:h});case 27:case"end":return e.stop()}},e)}))()},_initializePageLabels:function(s){var l=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,n,r,i,o,a;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getPageLabels();case 2:if(t=e.sent,s!==l.pdfDocument)return e.abrupt("return");e.next=5;break;case 5:if(!t||_app_options.AppOptions.get("disablePageLabels"))return e.abrupt("return");e.next=7;break;case 7:if((n=t.length)!==l.pagesCount)return console.error("The number of Page Labels does not match the number of pages in the document."),e.abrupt("return");e.next=11;break;case 11:for(r=0;r<n&&t[r]===(r+1).toString();)r++;if(r===n)return e.abrupt("return");e.next=15;break;case 15:i=l.pdfViewer,o=l.pdfThumbnailViewer,a=l.toolbar,i.setPageLabels(t),o.setPageLabels(t),a.setPagesCount(n,!0),a.setPageNumber(i.currentPageNumber,i.currentPageLabel);case 20:case"end":return e.stop()}},e)}))()},_initializePdfHistory:function(e){var t=e.fingerprint,n=e.viewOnLoad,r=e.initialDest,i=void 0===r?null:r;this.isViewerEmbedded||_app_options.AppOptions.get("disableHistory")||(this.pdfHistory.initialize({fingerprint:t,resetHistory:n===ViewOnLoad.INITIAL,updateUrl:_app_options.AppOptions.get("historyUpdateUrl")}),this.pdfHistory.initialBookmark&&(this.initialBookmark=this.pdfHistory.initialBookmark,this.initialRotation=this.pdfHistory.initialRotation),i&&!this.initialBookmark&&n===ViewOnLoad.UNKNOWN&&(this.initialBookmark=JSON.stringify(i),this.pdfHistory.push({explicitDest:i,pageNumber:null})))},_initializePermissions:function(n){var r=this;return _asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getPermissions();case 2:if(t=e.sent,n!==r.pdfDocument)return e.abrupt("return");e.next=5;break;case 5:if(t&&_app_options.AppOptions.get("enablePermissions")){e.next=7;break}return e.abrupt("return");case 7:t.includes(_pdf.PermissionFlag.COPY)||r.appConfig.viewerContainer.classList.add(ENABLE_PERMISSIONS_CLASS);case 8:case"end":return e.stop()}},e)}))()},_initializeAnnotationStorageCallbacks:function(e){var t=this;if(e===this.pdfDocument){var n=e.annotationStorage;n.onSetModified=function(){window.addEventListener("beforeunload",beforeUnload),t._annotationStorageModified=!0},n.onResetModified=function(){window.removeEventListener("beforeunload",beforeUnload),delete t._annotationStorageModified}}},setInitialView:function(e){var t,n,r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=i.rotation,a=i.sidebarView,s=i.scrollMode,l=i.spreadMode,p=function(e){(0,_ui_utils.isValidRotation)(e)&&(r.pdfViewer.pagesRotation=e)};this.isInitialViewSet=!0,this.pdfSidebar.setInitialView(a),t=s,n=l,(0,_ui_utils.isValidScrollMode)(t)&&(r.pdfViewer.scrollMode=t),(0,_ui_utils.isValidSpreadMode)(n)&&(r.pdfViewer.spreadMode=n),this.initialBookmark?(p(this.initialRotation),delete this.initialRotation,this.pdfLinkService.setHash(this.initialBookmark),this.initialBookmark=null):e&&(p(o),this.pdfLinkService.setHash(e)),this.toolbar.setPageNumber(this.pdfViewer.currentPageNumber,this.pdfViewer.currentPageLabel),this.secondaryToolbar.setPageNumber(this.pdfViewer.currentPageNumber),this.pdfViewer.currentScaleValue||(this.pdfViewer.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE)},_cleanup:function(){this.pdfDocument&&(this.pdfViewer.cleanup(),this.pdfThumbnailViewer.cleanup(),this.pdfDocument.cleanup(this.pdfViewer.renderer===_ui_utils.RendererType.SVG))},forceRendering:function(){this.pdfRenderingQueue.printing=!!this.printService,this.pdfRenderingQueue.isThumbnailViewEnabled=this.pdfSidebar.isThumbnailViewVisible,this.pdfRenderingQueue.renderHighestPriority()},beforePrint:function(){var t=this;if(this.pdfScriptingManager.dispatchWillPrint(),!this.printService)if(this.supportsPrinting)if(this.pdfViewer.pageViewsReady){var e=this.pdfViewer.getPagesOverview(),n=this.appConfig.printContainer,r=_app_options.AppOptions.get("printResolution"),i=this.pdfViewer.optionalContentConfigPromise,o=PDFPrintServiceFactory.instance.createPrintService(this.pdfDocument,e,n,r,i,this.l10n);this.printService=o,this.forceRendering(),o.layout(),this.externalServices.reportTelemetry({type:"print"})}else this.l10n.get("printing_not_ready").then(function(e){window.alert(e)});else this.l10n.get("printing_not_supported").then(function(e){t._otherError(e)})},afterPrint:function(){this.pdfScriptingManager.dispatchDidPrint(),this.printService&&(this.printService.destroy(),this.printService=null,this.pdfDocument&&this.pdfDocument.annotationStorage.resetModified()),this.forceRendering()},rotatePages:function(e){this.pdfViewer.pagesRotation+=e},requestPresentationMode:function(){this.pdfPresentationMode&&this.pdfPresentationMode.request()},triggerPrinting:function(){this.supportsPrinting&&window.print()},bindEvents:function(){var e=this.eventBus,t=this._boundEvents;t.beforePrint=this.beforePrint.bind(this),t.afterPrint=this.afterPrint.bind(this),e._on("resize",webViewerResize),e._on("hashchange",webViewerHashchange),e._on("beforeprint",t.beforePrint),e._on("afterprint",t.afterPrint),e._on("pagerendered",webViewerPageRendered),e._on("updateviewarea",webViewerUpdateViewarea),e._on("pagechanging",webViewerPageChanging),e._on("scalechanging",webViewerScaleChanging),e._on("rotationchanging",webViewerRotationChanging),e._on("sidebarviewchanged",webViewerSidebarViewChanged),e._on("pagemode",webViewerPageMode),e._on("namedaction",webViewerNamedAction),e._on("presentationmodechanged",webViewerPresentationModeChanged),e._on("presentationmode",webViewerPresentationMode),e._on("print",webViewerPrint),e._on("download",webViewerDownload),e._on("save",webViewerSave),e._on("firstpage",webViewerFirstPage),e._on("lastpage",webViewerLastPage),e._on("nextpage",webViewerNextPage),e._on("previouspage",webViewerPreviousPage),e._on("zoomin",webViewerZoomIn),e._on("zoomout",webViewerZoomOut),e._on("zoomreset",webViewerZoomReset),e._on("pagenumberchanged",webViewerPageNumberChanged),e._on("scalechanged",webViewerScaleChanged),e._on("rotatecw",webViewerRotateCw),e._on("rotateccw",webViewerRotateCcw),e._on("optionalcontentconfig",webViewerOptionalContentConfig),e._on("switchscrollmode",webViewerSwitchScrollMode),e._on("scrollmodechanged",webViewerScrollModeChanged),e._on("switchspreadmode",webViewerSwitchSpreadMode),e._on("spreadmodechanged",webViewerSpreadModeChanged),e._on("documentproperties",webViewerDocumentProperties),e._on("find",webViewerFind),e._on("findfromurlhash",webViewerFindFromUrlHash),e._on("updatefindmatchescount",webViewerUpdateFindMatchesCount),e._on("updatefindcontrolstate",webViewerUpdateFindControlState),_app_options.AppOptions.get("pdfBug")&&(t.reportPageStatsPDFBug=reportPageStatsPDFBug,e._on("pagerendered",t.reportPageStatsPDFBug),e._on("pagechanging",t.reportPageStatsPDFBug)),e._on("fileinputchange",webViewerFileInputChange),e._on("openfile",webViewerOpenFile)},bindWindowEvents:function(){var t=this.eventBus,e=this._boundEvents;e.windowResize=function(){t.dispatch("resize",{source:window})},e.windowHashChange=function(){t.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)})},e.windowBeforePrint=function(){t.dispatch("beforeprint",{source:window})},e.windowAfterPrint=function(){t.dispatch("afterprint",{source:window})},e.windowUpdateFromSandbox=function(e){t.dispatch("updatefromsandbox",{source:window,detail:e.detail})},window.addEventListener("visibilitychange",webViewerVisibilityChange),window.addEventListener("wheel",webViewerWheel,{passive:!1}),window.addEventListener("touchstart",webViewerTouchStart,{passive:!1}),window.addEventListener("click",webViewerClick),window.addEventListener("keydown",webViewerKeyDown),window.addEventListener("keyup",webViewerKeyUp),window.addEventListener("resize",e.windowResize),window.addEventListener("hashchange",e.windowHashChange),window.addEventListener("beforeprint",e.windowBeforePrint),window.addEventListener("afterprint",e.windowAfterPrint),window.addEventListener("updatefromsandbox",e.windowUpdateFromSandbox)},unbindEvents:function(){var e=this.eventBus,t=this._boundEvents;e._off("resize",webViewerResize),e._off("hashchange",webViewerHashchange),e._off("beforeprint",t.beforePrint),e._off("afterprint",t.afterPrint),e._off("pagerendered",webViewerPageRendered),e._off("updateviewarea",webViewerUpdateViewarea),e._off("pagechanging",webViewerPageChanging),e._off("scalechanging",webViewerScaleChanging),e._off("rotationchanging",webViewerRotationChanging),e._off("sidebarviewchanged",webViewerSidebarViewChanged),e._off("pagemode",webViewerPageMode),e._off("namedaction",webViewerNamedAction),e._off("presentationmodechanged",webViewerPresentationModeChanged),e._off("presentationmode",webViewerPresentationMode),e._off("print",webViewerPrint),e._off("download",webViewerDownload),e._off("save",webViewerSave),e._off("firstpage",webViewerFirstPage),e._off("lastpage",webViewerLastPage),e._off("nextpage",webViewerNextPage),e._off("previouspage",webViewerPreviousPage),e._off("zoomin",webViewerZoomIn),e._off("zoomout",webViewerZoomOut),e._off("zoomreset",webViewerZoomReset),e._off("pagenumberchanged",webViewerPageNumberChanged),e._off("scalechanged",webViewerScaleChanged),e._off("rotatecw",webViewerRotateCw),e._off("rotateccw",webViewerRotateCcw),e._off("optionalcontentconfig",webViewerOptionalContentConfig),e._off("switchscrollmode",webViewerSwitchScrollMode),e._off("scrollmodechanged",webViewerScrollModeChanged),e._off("switchspreadmode",webViewerSwitchSpreadMode),e._off("spreadmodechanged",webViewerSpreadModeChanged),e._off("documentproperties",webViewerDocumentProperties),e._off("find",webViewerFind),e._off("findfromurlhash",webViewerFindFromUrlHash),e._off("updatefindmatchescount",webViewerUpdateFindMatchesCount),e._off("updatefindcontrolstate",webViewerUpdateFindControlState),t.reportPageStatsPDFBug&&(e._off("pagerendered",t.reportPageStatsPDFBug),e._off("pagechanging",t.reportPageStatsPDFBug),t.reportPageStatsPDFBug=null),e._off("fileinputchange",webViewerFileInputChange),e._off("openfile",webViewerOpenFile),t.beforePrint=null,t.afterPrint=null},unbindWindowEvents:function(){var e=this._boundEvents;window.removeEventListener("visibilitychange",webViewerVisibilityChange),window.removeEventListener("wheel",webViewerWheel,{passive:!1}),window.removeEventListener("touchstart",webViewerTouchStart,{passive:!1}),window.removeEventListener("click",webViewerClick),window.removeEventListener("keydown",webViewerKeyDown),window.removeEventListener("keyup",webViewerKeyUp),window.removeEventListener("resize",e.windowResize),window.removeEventListener("hashchange",e.windowHashChange),window.removeEventListener("beforeprint",e.windowBeforePrint),window.removeEventListener("afterprint",e.windowAfterPrint),window.removeEventListener("updatefromsandbox",e.windowUpdateFromSandbox),e.windowResize=null,e.windowHashChange=null,e.windowBeforePrint=null,e.windowAfterPrint=null,e.windowUpdateFromSandbox=null},accumulateWheelTicks:function(e){(0<this._wheelUnusedTicks&&e<0||this._wheelUnusedTicks<0&&0<e)&&(this._wheelUnusedTicks=0),this._wheelUnusedTicks+=e;var t=Math.sign(this._wheelUnusedTicks)*Math.floor(Math.abs(this._wheelUnusedTicks));return this._wheelUnusedTicks-=t,t},_unblockDocumentLoadEvent:function(){document.blockUnblockOnload&&document.blockUnblockOnload(!1),this._unblockDocumentLoadEvent=function(){}},get scriptingReady(){return this.pdfScriptingManager.ready}};exports.PDFViewerApplication=PDFViewerApplication;var webViewerFileInputChange,webViewerOpenFile,HOSTED_VIEWER_ORIGINS=["null","http://mozilla.github.io","https://mozilla.github.io"];function loadFakeWorker(){return _loadFakeWorker.apply(this,arguments)}function _loadFakeWorker(){return(_loadFakeWorker=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return _pdf.GlobalWorkerOptions.workerSrc||(_pdf.GlobalWorkerOptions.workerSrc=_app_options.AppOptions.get("workerSrc")),e.abrupt("return",(0,_pdf.loadScript)(_pdf.PDFWorker.getWorkerSrc()));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function loadAndEnablePDFBug(e){var t=PDFViewerApplication.appConfig;return(0,_pdf.loadScript)(t.debuggerScriptPath).then(function(){PDFBug.enable(e),PDFBug.init({OPS:_pdf.OPS},t.mainContainer)})}function reportPageStatsPDFBug(e){var t,n=e.pageNumber;if("undefined"!=typeof Stats&&Stats.enabled){var r=PDFViewerApplication.pdfViewer.getPageView(n-1),i=null==r?void 0:null===(t=r.pdfPage)||void 0===t?void 0:t.stats;i&&Stats.add(n,i)}}function webViewerInitialized(){var e,t=PDFViewerApplication.appConfig,n=document.location.search.substring(1),r=(0,_ui_utils.parseQueryString)(n);e="file"in r?r.file:_app_options.AppOptions.get("defaultUrl"),validateFileURL(e);var i=document.createElement("input");i.id=t.openFileInputName,i.className="fileInput",i.setAttribute("type","file"),i.oncontextmenu=_ui_utils.noContextMenuHandler,document.body.appendChild(i),window.File&&window.FileReader&&window.FileList&&window.Blob?i.value=null:(t.toolbar.openFile.hidden=!0,t.secondaryToolbar.openFileButton.hidden=!0),i.addEventListener("change",function(e){var t=e.target.files;t&&0!==t.length&&PDFViewerApplication.eventBus.dispatch("fileinputchange",{source:this,fileInput:e.target})}),t.mainContainer.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}),t.mainContainer.addEventListener("drop",function(e){e.preventDefault();var t=e.dataTransfer.files;t&&0!==t.length&&PDFViewerApplication.eventBus.dispatch("fileinputchange",{source:this,fileInput:e.dataTransfer})}),PDFViewerApplication.supportsDocumentFonts||(_app_options.AppOptions.set("disableFontFace",!0),PDFViewerApplication.l10n.get("web_fonts_disabled").then(function(e){console.warn(e)})),PDFViewerApplication.supportsPrinting||(t.toolbar.print.classList.add("hidden"),t.secondaryToolbar.printButton.classList.add("hidden")),PDFViewerApplication.supportsFullscreen||(t.toolbar.presentationModeButton.classList.add("hidden"),t.secondaryToolbar.presentationModeButton.classList.add("hidden")),PDFViewerApplication.supportsIntegratedFind&&t.toolbar.viewFind.classList.add("hidden"),t.mainContainer.addEventListener("transitionend",function(e){e.target===this&&PDFViewerApplication.eventBus.dispatch("resize",{source:this})},!0);try{webViewerOpenFileViaURL(e)}catch(t){PDFViewerApplication.l10n.get("loading_error").then(function(e){PDFViewerApplication._documentError(e,t)})}}function webViewerOpenFileViaURL(e){e&&PDFViewerApplication.open(e)}function webViewerResetPermissions(){var e=PDFViewerApplication.appConfig;e&&e.viewerContainer.classList.remove(ENABLE_PERMISSIONS_CLASS)}function webViewerPageRendered(e){var t=e.pageNumber,n=e.timestamp,r=e.error;if(t===PDFViewerApplication.page&&PDFViewerApplication.toolbar.updateLoadingIndicatorState(!1),PDFViewerApplication.pdfSidebar.isThumbnailViewVisible){var i=PDFViewerApplication.pdfViewer.getPageView(t-1),o=PDFViewerApplication.pdfThumbnailViewer.getThumbnail(t-1);i&&o&&o.setImage(i)}r&&PDFViewerApplication.l10n.get("rendering_error").then(function(e){PDFViewerApplication._otherError(e,r)}),PDFViewerApplication.externalServices.reportTelemetry({type:"pageInfo",timestamp:n}),PDFViewerApplication.pdfDocument.getStats().then(function(e){PDFViewerApplication.externalServices.reportTelemetry({type:"documentStats",stats:e})})}function webViewerPageMode(e){var t,n=e.mode;switch(n){case"thumbs":t=_ui_utils.SidebarView.THUMBS;break;case"bookmarks":case"outline":t=_ui_utils.SidebarView.OUTLINE;break;case"attachments":t=_ui_utils.SidebarView.ATTACHMENTS;break;case"layers":t=_ui_utils.SidebarView.LAYERS;break;case"none":t=_ui_utils.SidebarView.NONE;break;default:return void console.error('Invalid "pagemode" hash parameter: '+n)}PDFViewerApplication.pdfSidebar.switchView(t,!0)}function webViewerNamedAction(e){switch(e.action){case"GoToPage":PDFViewerApplication.appConfig.toolbar.pageNumber.select();break;case"Find":PDFViewerApplication.supportsIntegratedFind||PDFViewerApplication.findBar.toggle();break;case"Print":PDFViewerApplication.triggerPrinting();break;case"SaveAs":webViewerSave()}}function webViewerPresentationModeChanged(e){PDFViewerApplication.pdfViewer.presentationModeState=e.state}function webViewerSidebarViewChanged(e){PDFViewerApplication.pdfRenderingQueue.isThumbnailViewEnabled=PDFViewerApplication.pdfSidebar.isThumbnailViewVisible;var t=PDFViewerApplication.store;t&&PDFViewerApplication.isInitialViewSet&&t.set("sidebarView",e.view).catch(function(){})}function webViewerUpdateViewarea(e){var t=e.location,n=PDFViewerApplication.store;n&&PDFViewerApplication.isInitialViewSet&&n.setMultiple({page:t.pageNumber,zoom:t.scale,scrollLeft:t.left,scrollTop:t.top,rotation:t.rotation}).catch(function(){});var r=PDFViewerApplication.pdfLinkService.getAnchorUrl(t.pdfOpenParams);PDFViewerApplication.appConfig.toolbar.viewBookmark.href=r,PDFViewerApplication.appConfig.secondaryToolbar.viewBookmarkButton.href=r;var i=PDFViewerApplication.pdfViewer.getPageView(PDFViewerApplication.page-1),o=(null==i?void 0:i.renderingState)!==_pdf_rendering_queue.RenderingStates.FINISHED;PDFViewerApplication.toolbar.updateLoadingIndicatorState(o)}function webViewerScrollModeChanged(e){var t=PDFViewerApplication.store;t&&PDFViewerApplication.isInitialViewSet&&t.set("scrollMode",e.mode).catch(function(){})}function webViewerSpreadModeChanged(e){var t=PDFViewerApplication.store;t&&PDFViewerApplication.isInitialViewSet&&t.set("spreadMode",e.mode).catch(function(){})}function webViewerResize(){var e=PDFViewerApplication.pdfDocument,t=PDFViewerApplication.pdfViewer;if(e){var n=t.currentScaleValue;"auto"!==n&&"page-fit"!==n&&"page-width"!==n||(t.currentScaleValue=n),t.update()}}function webViewerHashchange(e){var t=e.hash;t&&(PDFViewerApplication.isInitialViewSet?PDFViewerApplication.pdfHistory.popStateInProgress||PDFViewerApplication.pdfLinkService.setHash(t):PDFViewerApplication.initialBookmark=t)}function webViewerPresentationMode(){PDFViewerApplication.requestPresentationMode()}function webViewerPrint(){PDFViewerApplication.triggerPrinting()}function webViewerDownload(){PDFViewerApplication.downloadOrSave({sourceEventType:"download"})}function webViewerSave(){PDFViewerApplication.downloadOrSave({sourceEventType:"save"})}function webViewerFirstPage(){PDFViewerApplication.pdfDocument&&(PDFViewerApplication.page=1)}function webViewerLastPage(){PDFViewerApplication.pdfDocument&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount)}function webViewerNextPage(){PDFViewerApplication.pdfViewer.nextPage()}function webViewerPreviousPage(){PDFViewerApplication.pdfViewer.previousPage()}function webViewerZoomIn(){PDFViewerApplication.zoomIn()}function webViewerZoomOut(){PDFViewerApplication.zoomOut()}function webViewerZoomReset(){PDFViewerApplication.zoomReset()}function webViewerPageNumberChanged(e){var t=PDFViewerApplication.pdfViewer;""!==e.value&&PDFViewerApplication.pdfLinkService.goToPage(e.value),e.value!==t.currentPageNumber.toString()&&e.value!==t.currentPageLabel&&PDFViewerApplication.toolbar.setPageNumber(t.currentPageNumber,t.currentPageLabel)}function webViewerScaleChanged(e){PDFViewerApplication.pdfViewer.currentScaleValue=e.value}function webViewerRotateCw(){PDFViewerApplication.rotatePages(90)}function webViewerRotateCcw(){PDFViewerApplication.rotatePages(-90)}function webViewerOptionalContentConfig(e){PDFViewerApplication.pdfViewer.optionalContentConfigPromise=e.promise}function webViewerSwitchScrollMode(e){PDFViewerApplication.pdfViewer.scrollMode=e.mode}function webViewerSwitchSpreadMode(e){PDFViewerApplication.pdfViewer.spreadMode=e.mode}function webViewerDocumentProperties(){PDFViewerApplication.pdfDocumentProperties.open()}function webViewerFind(e){PDFViewerApplication.findController.executeCommand("find"+e.type,{query:e.query,phraseSearch:e.phraseSearch,caseSensitive:e.caseSensitive,entireWord:e.entireWord,highlightAll:e.highlightAll,findPrevious:e.findPrevious})}function webViewerFindFromUrlHash(e){PDFViewerApplication.findController.executeCommand("find",{query:e.query,phraseSearch:e.phraseSearch,caseSensitive:!1,entireWord:!1,highlightAll:!0,findPrevious:!1})}function webViewerUpdateFindMatchesCount(e){var t=e.matchesCount;PDFViewerApplication.supportsIntegratedFind?PDFViewerApplication.externalServices.updateFindMatchesCount(t):PDFViewerApplication.findBar.updateResultsCount(t)}function webViewerUpdateFindControlState(e){var t=e.state,n=e.previous,r=e.matchesCount,i=e.rawQuery;PDFViewerApplication.supportsIntegratedFind?PDFViewerApplication.externalServices.updateFindControlState({result:t,findPrevious:n,matchesCount:r,rawQuery:i}):PDFViewerApplication.findBar.updateUIState(t,n,r)}function webViewerScaleChanging(e){PDFViewerApplication.toolbar.setPageScale(e.presetValue,e.scale),PDFViewerApplication.pdfViewer.update()}function webViewerRotationChanging(e){PDFViewerApplication.pdfThumbnailViewer.pagesRotation=e.pagesRotation,PDFViewerApplication.forceRendering(),PDFViewerApplication.pdfViewer.currentPageNumber=e.pageNumber}function webViewerPageChanging(e){var t=e.pageNumber,n=e.pageLabel;PDFViewerApplication.toolbar.setPageNumber(t,n),PDFViewerApplication.secondaryToolbar.setPageNumber(t),PDFViewerApplication.pdfSidebar.isThumbnailViewVisible&&PDFViewerApplication.pdfThumbnailViewer.scrollThumbnailIntoView(t)}function webViewerVisibilityChange(e){"visible"===document.visibilityState&&setZoomDisabledTimeout()}validateFileURL=function(e){if(void 0!==e)try{var t=new URL(window.location.href).origin||"null";if(HOSTED_VIEWER_ORIGINS.includes(t))return;var n=new URL(e,window.location.href),r=n.origin,i=n.protocol;if(r!==t&&"blob:"!==i)throw new Error("file origin does not match viewer's")}catch(t){throw PDFViewerApplication.l10n.get("loading_error").then(function(e){PDFViewerApplication._documentError(e,{message:null==t?void 0:t.message})}),t}},webViewerFileInputChange=function(e){var t;if(null===(t=PDFViewerApplication.pdfViewer)||void 0===t||!t.isInPresentationMode){var n=e.fileInput.files[0];if(_viewer_compatibility.viewerCompatibilityParams.disableCreateObjectURL){PDFViewerApplication.setTitleUsingUrl(n.name);var r=new FileReader;r.onload=function(e){var t=e.target.result;PDFViewerApplication.open(new Uint8Array(t))},r.readAsArrayBuffer(n)}else{var i=URL.createObjectURL(n);n.name&&(i={url:i,originalUrl:n.name}),PDFViewerApplication.open(i)}var o=PDFViewerApplication.appConfig;o.toolbar.viewBookmark.hidden=!0,o.secondaryToolbar.viewBookmarkButton.hidden=!0,o.toolbar.download.hidden=!0,o.secondaryToolbar.downloadButton.hidden=!0}};var zoomDisabledTimeout=null;function setZoomDisabledTimeout(){zoomDisabledTimeout&&clearTimeout(zoomDisabledTimeout),zoomDisabledTimeout=setTimeout(function(){zoomDisabledTimeout=null},WHEEL_ZOOM_DISABLED_TIMEOUT)}function webViewerWheel(e){var t=PDFViewerApplication.pdfViewer,n=PDFViewerApplication.supportedMouseWheelZoomModifierKeys;if(!t.isInPresentationMode)if(e.ctrlKey&&n.ctrlKey||e.metaKey&&n.metaKey){if(e.preventDefault(),zoomDisabledTimeout||"hidden"===document.visibilityState)return;var r=t.currentScale,i=(0,_ui_utils.normalizeWheelEventDirection)(e),o=0;if(e.deltaMode===WheelEvent.DOM_DELTA_LINE||e.deltaMode===WheelEvent.DOM_DELTA_PAGE)o=1<=Math.abs(i)?Math.sign(i):PDFViewerApplication.accumulateWheelTicks(i);else{o=PDFViewerApplication.accumulateWheelTicks(i/30)}o<0?PDFViewerApplication.zoomOut(-o):0<o&&PDFViewerApplication.zoomIn(o);var a=t.currentScale;if(r!==a){var s=a/r-1,l=t.container.getBoundingClientRect(),p=e.clientX-l.left,c=e.clientY-l.top;t.container.scrollLeft+=p*s,t.container.scrollTop+=c*s}}else setZoomDisabledTimeout()}function webViewerTouchStart(e){1<e.touches.length&&e.preventDefault()}function webViewerClick(e){if(PDFViewerApplication.triggerDelayedFallback&&PDFViewerApplication.pdfViewer.containsElement(e.target)&&PDFViewerApplication.triggerDelayedFallback(),PDFViewerApplication.secondaryToolbar.isOpen){var t=PDFViewerApplication.appConfig;(PDFViewerApplication.pdfViewer.containsElement(e.target)||t.toolbar.container.contains(e.target)&&e.target!==t.secondaryToolbar.toggleButton)&&PDFViewerApplication.secondaryToolbar.close()}}function webViewerKeyUp(e){9===e.keyCode&&PDFViewerApplication.triggerDelayedFallback&&PDFViewerApplication.triggerDelayedFallback()}function webViewerKeyDown(e){if(!PDFViewerApplication.overlayManager.active){var t=!1,n=!1,r=(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0),i=PDFViewerApplication.pdfViewer,o=null==i?void 0:i.isInPresentationMode;if(1===r||8===r||5===r||12===r)switch(e.keyCode){case 70:PDFViewerApplication.supportsIntegratedFind||e.shiftKey||(PDFViewerApplication.findBar.open(),t=!0);break;case 71:if(!PDFViewerApplication.supportsIntegratedFind){var a=PDFViewerApplication.findController.state;a&&PDFViewerApplication.findController.executeCommand("findagain",{query:a.query,phraseSearch:a.phraseSearch,caseSensitive:a.caseSensitive,entireWord:a.entireWord,highlightAll:a.highlightAll,findPrevious:5===r||12===r}),t=!0}break;case 61:case 107:case 187:case 171:o||PDFViewerApplication.zoomIn(),t=!0;break;case 173:case 109:case 189:o||PDFViewerApplication.zoomOut(),t=!0;break;case 48:case 96:o||(setTimeout(function(){PDFViewerApplication.zoomReset()}),t=!1);break;case 38:(o||1<PDFViewerApplication.page)&&(PDFViewerApplication.page=1,n=t=!0);break;case 40:(o||PDFViewerApplication.page<PDFViewerApplication.pagesCount)&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount,n=t=!0)}var s=PDFViewerApplication.eventBus;if(1===r||8===r)switch(e.keyCode){case 83:s.dispatch("download",{source:window}),t=!0;break;case 79:s.dispatch("openfile",{source:window}),t=!0}if(3===r||10===r)switch(e.keyCode){case 80:PDFViewerApplication.requestPresentationMode(),t=!0;break;case 71:PDFViewerApplication.appConfig.toolbar.pageNumber.select(),t=!0}if(t)return n&&!o&&i.focus(),void e.preventDefault();var l=(0,_ui_utils.getActiveOrFocusedElement)(),p=null==l?void 0:l.tagName.toUpperCase();if(!("INPUT"===p||"TEXTAREA"===p||"SELECT"===p||null!=l&&l.isContentEditable)||27===e.keyCode){if(0===r){var c=0,u=!1;switch(e.keyCode){case 38:case 33:i.isVerticalScrollbarEnabled&&(u=!0),c=-1;break;case 8:o||(u=!0),c=-1;break;case 37:i.isHorizontalScrollbarEnabled&&(u=!0);case 75:case 80:c=-1;break;case 27:PDFViewerApplication.secondaryToolbar.isOpen&&(PDFViewerApplication.secondaryToolbar.close(),t=!0),!PDFViewerApplication.supportsIntegratedFind&&PDFViewerApplication.findBar.opened&&(PDFViewerApplication.findBar.close(),t=!0);break;case 40:case 34:i.isVerticalScrollbarEnabled&&(u=!0),c=1;break;case 13:case 32:o||(u=!0),c=1;break;case 39:i.isHorizontalScrollbarEnabled&&(u=!0);case 74:case 78:c=1;break;case 36:(o||1<PDFViewerApplication.page)&&(PDFViewerApplication.page=1,n=t=!0);break;case 35:(o||PDFViewerApplication.page<PDFViewerApplication.pagesCount)&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount,n=t=!0);break;case 83:PDFViewerApplication.pdfCursorTools.switchTool(_pdf_cursor_tools.CursorTool.SELECT);break;case 72:PDFViewerApplication.pdfCursorTools.switchTool(_pdf_cursor_tools.CursorTool.HAND);break;case 82:PDFViewerApplication.rotatePages(90);break;case 115:PDFViewerApplication.pdfSidebar.toggle()}0===c||u&&"page-fit"!==i.currentScaleValue||(0<c?i.nextPage():i.previousPage(),t=!0)}if(4===r)switch(e.keyCode){case 13:case 32:if(!o&&"page-fit"!==i.currentScaleValue)break;1<PDFViewerApplication.page&&PDFViewerApplication.page--,t=!0;break;case 82:PDFViewerApplication.rotatePages(-90)}t||o||(33<=e.keyCode&&e.keyCode<=40||32===e.keyCode&&"BUTTON"!==p)&&(n=!0),n&&!i.containsElement(l)&&i.focus(),t&&e.preventDefault()}}}function beforeUnload(e){return e.preventDefault(),e.returnValue="",!1}var PDFPrintServiceFactory={instance:{supportsPrinting:!(webViewerOpenFile=function(e){var t=PDFViewerApplication.appConfig.openFileInputName;document.getElementById(t).click()}),createPrintService:function(){throw new Error("Not implemented: createPrintService")}}};exports.PDFPrintServiceFactory=PDFPrintServiceFactory;