"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _regeneratorRuntime(){_regeneratorRuntime=function(){return o};var o={},e=Object.prototype,l=e.hasOwnProperty,c=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,r){return e[t]=r}}function s(e,t,r,i){var a,o,s,h,n=t&&t.prototype instanceof f?t:f,u=Object.create(n.prototype),l=new S(i||[]);return c(u,"_invoke",{value:(a=e,o=r,s=l,h="suspendedStart",function(e,t){if("executing"===h)throw new Error("Generator is already running");if("completed"===h){if("throw"===e)throw t;return C()}for(s.method=e,s.arg=t;;){var r=s.delegate;if(r){var i=L(r,s);if(i){if(i===p)continue;return i}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if("suspendedStart"===h)throw h="completed",s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);h="executing";var n=d(a,o,s);if("normal"===n.type){if(h=s.done?"completed":"suspendedYield",n.arg===p)continue;return{value:n.arg,done:s.done}}"throw"===n.type&&(h="completed",s.method="throw",s.arg=n.arg)}})}),u}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}o.wrap=s;var p={};function f(){}function h(){}function u(){}var v={};a(v,n,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(P([])));g&&g!==e&&l.call(g,n)&&(v=g);var m=u.prototype=f.prototype=Object.create(v);function _(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function w(h,u){var t;c(this,"_invoke",{value:function(r,i){function e(){return new u(function(e,t){!function t(e,r,i,n){var a=d(h[e],h,r);if("throw"!==a.type){var o=a.arg,s=o.value;return s&&"object"==_typeof(s)&&l.call(s,"__await")?u.resolve(s.__await).then(function(e){t("next",e,i,n)},function(e){t("throw",e,i,n)}):u.resolve(s).then(function(e){o.value=e,i(o)},function(e){return t("throw",e,i,n)})}n(a.arg)}(r,i,e,t)})}return t=t?t.then(e,e):e()}})}function L(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,L(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var n=d(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,p;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function P(t){if(t){var e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return c(m,"constructor",{value:h.prototype=u,configurable:!0}),c(u,"constructor",{value:h,configurable:!0}),h.displayName=a(u,i,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,a(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e},o.awrap=function(e){return{__await:e}},_(w.prototype),a(w.prototype,r,function(){return this}),o.AsyncIterator=w,o.async=function(e,t,r,i,n){void 0===n&&(n=Promise);var a=new w(s(e,t,r,i),n);return o.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},_(m),a(m,i,"Generator"),a(m,n,function(){return this}),a(m,"toString",function(){return"[object Generator]"}),o.keys=function(e){var r=Object(e),i=[];for(var t in r)i.push(t);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=P,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var i=this;function e(e,t){return a.type="throw",a.arg=r,i.next=e,t&&(i.method="next",i.arg=void 0),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t],a=n.completion;if("root"===n.tryLoc)return e("end");if(n.tryLoc<=this.prev){var o=l.call(n,"catchLoc"),s=l.call(n,"finallyLoc");if(o&&s){if(this.prev<n.catchLoc)return e(n.catchLoc,!0);if(this.prev<n.finallyLoc)return e(n.finallyLoc)}else if(o){if(this.prev<n.catchLoc)return e(n.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return e(n.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&l.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=e,a.arg=t,n?(this.method="next",this.next=n.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),b(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;b(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},o}function asyncGeneratorStep(e,t,r,i,n,a,o){try{var s=e[a](o),h=s.value}catch(e){return void r(e)}s.done?t(h):Promise.resolve(h).then(i,n)}function _asyncToGenerator(s){return function(){var e=this,o=arguments;return new Promise(function(t,r){var i=s.apply(e,o);function n(e){asyncGeneratorStep(i,t,r,n,a,"next",e)}function a(e){asyncGeneratorStep(i,t,r,n,a,"throw",e)}n(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);var i=r.call(e,t||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFPageView=void 0;var _ui_utils=require("./ui_utils.js"),_pdf=require("../pdf"),_l10n_utils=require("./l10n_utils.js"),_pdf_rendering_queue=require("./pdf_rendering_queue.js"),_viewer_compatibility=require("./viewer_compatibility.js"),MAX_CANVAS_PIXELS=_viewer_compatibility.viewerCompatibilityParams.maxCanvasPixels||16777216,PDFPageView=function(){function n(e){_classCallCheck(this,n);var t=e.container,r=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||_ui_utils.DEFAULT_SCALE,this.viewport=r,this.pdfPageRotate=r.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=Number.isInteger(e.textLayerMode)?e.textLayerMode:_ui_utils.TextLayerMode.ENABLE,this.imageResourcesPath=e.imageResourcesPath||"",this.renderInteractiveForms=!1!==e.renderInteractiveForms,this.useOnlyCssZoom=e.useOnlyCssZoom||!1,this.maxCanvasPixels=e.maxCanvasPixels||MAX_CANVAS_PIXELS,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.textLayerFactory=e.textLayerFactory,this.annotationLayerFactory=e.annotationLayerFactory,this.xfaLayerFactory=e.xfaLayerFactory,this.renderer=e.renderer||_ui_utils.RendererType.CANVAS,this.enableWebGL=e.enableWebGL||!1,this.l10n=e.l10n||_l10n_utils.NullL10n,this.enableScripting=!0===e.enableScripting,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.renderingState=_pdf_rendering_queue.RenderingStates.INITIAL,this.resume=null,this._renderError=null,this.annotationLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null;var i=document.createElement("div");i.className="page",i.style.width=Math.floor(this.viewport.width)+"px",i.style.height=Math.floor(this.viewport.height)+"px",i.setAttribute("data-page-number",this.id),i.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(function(e){i.setAttribute("aria-label",e)}),this.div=i,t.appendChild(i)}var e,t;return _createClass(n,[{key:"setPdfPage",value:function(e){this.pdfPage=e,this.pdfPageRotate=e.rotate;var t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*_ui_utils.CSS_UNITS,rotation:t}),this.reset()}},{key:"destroy",value:function(){this.reset(),this.pdfPage&&this.pdfPage.cleanup()}},{key:"_renderAnnotationLayer",value:(t=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.prev=1,e.next=4,this.annotationLayer.render(this.viewport,"display");case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),t=e.t0;case 9:return e.prev=9,this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:t}),e.finish(9);case 12:case"end":return e.stop()}},e,this,[[1,6,9,12]])})),function(){return t.apply(this,arguments)})},{key:"_renderXfaLayer",value:(e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.prev=1,e.next=4,this.xfaLayer.render(this.viewport,"display");case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),t=e.t0;case 9:return e.prev=9,this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:t}),e.finish(9);case 12:case"end":return e.stop()}},e,this,[[1,6,9,12]])})),function(){return e.apply(this,arguments)})},{key:"_resetZoomLayer",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this.zoomLayer){var t=this.zoomLayer.firstChild;this.paintedViewportMap.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null}}},{key:"reset",value:function(){var e,t,r=this,i=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.cancelRendering(n),this.renderingState=_pdf_rendering_queue.RenderingStates.INITIAL;var a=this.div;a.style.width=Math.floor(this.viewport.width)+"px",a.style.height=Math.floor(this.viewport.height)+"px";for(var o=a.childNodes,s=i&&this.zoomLayer||null,h=n&&(null===(e=this.annotationLayer)||void 0===e?void 0:e.div)||null,u=(null===(t=this.xfaLayer)||void 0===t?void 0:t.div)||null,l=o.length-1;0<=l;l--){var c=o[l];s!==c&&h!==c&&u!==c&&a.removeChild(c)}a.removeAttribute("data-loaded"),h?this.annotationLayer.hide():this.annotationLayer&&(this.annotationLayer.cancel(),this.annotationLayer=null),s||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon",this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then(function(e){var t;null===(t=r.loadingIconDiv)||void 0===t||t.setAttribute("aria-label",e)}),a.appendChild(this.loadingIconDiv)}},{key:"update",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this.scale=e||this.scale,void 0!==t&&(this.rotation=t),r instanceof Promise&&(this._optionalContentConfigPromise=r);var i=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*_ui_utils.CSS_UNITS,rotation:i}),this.svg)return this.cssTransform(this.svg,!0),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});var n=!1;if(this.canvas&&0<this.maxCanvasPixels){var a=this.outputScale;(Math.floor(this.viewport.width)*a.sx|0)*(Math.floor(this.viewport.height)*a.sy|0)>this.maxCanvasPixels&&(n=!0)}if(this.canvas){if(this.useOnlyCssZoom||this.hasRestrictedScaling&&n)return this.cssTransform(this.canvas,!0),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});this.zoomLayer||this.canvas.hidden||(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform(this.zoomLayer.firstChild),this.reset(!0,!0)}},{key:"cancelRendering",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.paintTask&&(this.paintTask.cancel(),this.paintTask=null),this.resume=null,this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),!e&&this.annotationLayer&&(this.annotationLayer.cancel(),this.annotationLayer=null)}},{key:"cssTransform",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.viewport.width,i=this.viewport.height,n=this.div;e.style.width=e.parentNode.style.width=n.style.width=Math.floor(r)+"px",e.style.height=e.parentNode.style.height=n.style.height=Math.floor(i)+"px";var a=this.viewport.rotation-this.paintedViewportMap.get(e).rotation,o=Math.abs(a),s=1,h=1;if(90!==o&&270!==o||(s=i/r,h=r/i),e.style.transform="rotate(".concat(a,"deg) scale(").concat(s,", ").concat(h,")"),this.textLayer){var u=this.textLayer.viewport,l=this.viewport.rotation-u.rotation,c=Math.abs(l),d=r/u.width;90!==c&&270!==c||(d=r/u.height);var p,f,v=this.textLayer.textLayerDiv;switch(c){case 0:p=f=0;break;case 90:p=0,f="-"+v.style.height;break;case 180:p="-"+v.style.width,f="-"+v.style.height;break;case 270:p="-"+v.style.width,f=0;break;default:console.error("Bad rotation value.")}v.style.transform="rotate(".concat(c,"deg) ")+"scale(".concat(d,") ")+"translate(".concat(p,", ").concat(f,")"),v.style.transformOrigin="0% 0%"}t&&this.annotationLayer&&this._renderAnnotationLayer(),this.xfaLayer&&this._renderXfaLayer()}},{key:"width",get:function(){return this.viewport.width}},{key:"height",get:function(){return this.viewport.height}},{key:"getPagePoint",value:function(e,t){return this.viewport.convertToPdfPoint(e,t)}},{key:"draw",value:function(){var e,i=this;this.renderingState!==_pdf_rendering_queue.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());var n=this.div,t=this.pdfPage;if(!t)return this.renderingState=_pdf_rendering_queue.RenderingStates.FINISHED,this.loadingIconDiv&&(n.removeChild(this.loadingIconDiv),delete this.loadingIconDiv),Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=_pdf_rendering_queue.RenderingStates.RUNNING;var r=document.createElement("div");r.style.width=n.style.width,r.style.height=n.style.height,r.classList.add("canvasWrapper"),null!==(e=this.annotationLayer)&&void 0!==e&&e.div?n.insertBefore(r,this.annotationLayer.div):n.appendChild(r);var a=null;if(this.textLayerMode!==_ui_utils.TextLayerMode.DISABLE&&this.textLayerFactory){var o,s=document.createElement("div");s.className="textLayer",s.style.width=r.style.width,s.style.height=r.style.height,null!==(o=this.annotationLayer)&&void 0!==o&&o.div?n.insertBefore(s,this.annotationLayer.div):n.appendChild(s),a=this.textLayerFactory.createTextLayerBuilder(s,this.id-1,this.viewport,this.textLayerMode===_ui_utils.TextLayerMode.ENABLE_ENHANCE,this.eventBus)}this.textLayer=a;var h=null;this.renderingQueue&&(h=function(e){if(!i.renderingQueue.isHighestPriority(i))return i.renderingState=_pdf_rendering_queue.RenderingStates.PAUSED,void(i.resume=function(){i.renderingState=_pdf_rendering_queue.RenderingStates.RUNNING,e()});e()});var u=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark(function e(){var t,r=arguments;return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<r.length&&void 0!==r[0]?r[0]:null,l===i.paintTask&&(i.paintTask=null),t instanceof _pdf.RenderingCancelledException)return i._renderError=null,e.abrupt("return");e.next=5;break;case 5:if(i._renderError=t,i.renderingState=_pdf_rendering_queue.RenderingStates.FINISHED,i.loadingIconDiv&&(n.removeChild(i.loadingIconDiv),delete i.loadingIconDiv),i._resetZoomLayer(!0),i.eventBus.dispatch("pagerendered",{source:i,pageNumber:i.id,cssTransform:!1,timestamp:performance.now(),error:i._renderError}),t)throw t;e.next=12;break;case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),l=this.renderer===_ui_utils.RendererType.SVG?this.paintOnSvg(r):this.paintOnCanvas(r);l.onRenderContinue=h;var c=(this.paintTask=l).promise.then(function(){return u(null).then(function(){if(a){var e=t.streamTextContent({normalizeWhitespace:!0});a.setTextContentStream(e),a.render()}})},function(e){return u(e)});return this.annotationLayerFactory&&(this.annotationLayer||(this.annotationLayer=this.annotationLayerFactory.createAnnotationLayerBuilder(n,t,null,this.imageResourcesPath,this.renderInteractiveForms,this.l10n,this.enableScripting,null,null)),this._renderAnnotationLayer()),this.xfaLayerFactory&&(this.xfaLayer||(this.xfaLayer=this.xfaLayerFactory.createXfaLayerBuilder(n,t)),this._renderXfaLayer()),n.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),c}},{key:"paintOnCanvas",value:function(e){var t=(0,_pdf.createPromiseCapability)(),r={promise:t.promise,onRenderContinue:function(e){e()},cancel:function(){v.cancel()}},i=this.viewport,n=document.createElement("canvas"),a=n.hidden=!0,o=function(){a&&(n.hidden=!1,a=!1)};e.appendChild(n),(this.canvas=n).mozOpaque=!0;var s=n.getContext("2d",{alpha:!1}),h=(0,_ui_utils.getOutputScale)(s);if(this.outputScale=h,this.useOnlyCssZoom){var u=i.clone({scale:_ui_utils.CSS_UNITS});h.sx*=u.width/i.width,h.sy*=u.height/i.height,h.scaled=!0}if(0<this.maxCanvasPixels){var l=i.width*i.height,c=Math.sqrt(this.maxCanvasPixels/l);h.sx>c||h.sy>c?(h.sx=c,h.sy=c,h.scaled=!0,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}var d=(0,_ui_utils.approximateFraction)(h.sx),p=(0,_ui_utils.approximateFraction)(h.sy);n.width=(0,_ui_utils.roundToDivide)(i.width*h.sx,d[0]),n.height=(0,_ui_utils.roundToDivide)(i.height*h.sy,p[0]),n.style.width=(0,_ui_utils.roundToDivide)(i.width,d[1])+"px",n.style.height=(0,_ui_utils.roundToDivide)(i.height,p[1])+"px",this.paintedViewportMap.set(n,i);var f={canvasContext:s,transform:h.scaled?[h.sx,0,0,h.sy,0,0]:null,viewport:this.viewport,enableWebGL:this.enableWebGL,renderInteractiveForms:this.renderInteractiveForms,optionalContentConfigPromise:this._optionalContentConfigPromise},v=this.pdfPage.render(f);return v.onContinue=function(e){o(),r.onRenderContinue?r.onRenderContinue(e):e()},v.promise.then(function(){o(),t.resolve(void 0)},function(e){o(),t.reject(e)}),r}},{key:"paintOnSvg",value:function(t){var r=this,e=!1,i=function(){if(e)throw new _pdf.RenderingCancelledException("Rendering cancelled, page ".concat(r.id),"svg")},n=this.pdfPage,a=this.viewport.clone({scale:_ui_utils.CSS_UNITS});return{promise:n.getOperatorList().then(function(e){return i(),new _pdf.SVGGraphics(n.commonObjs,n.objs,_viewer_compatibility.viewerCompatibilityParams.disableCreateObjectURL).getSVG(e,a).then(function(e){i(),r.svg=e,r.paintedViewportMap.set(e,a),e.style.width=t.style.width,e.style.height=t.style.height,r.renderingState=_pdf_rendering_queue.RenderingStates.FINISHED,t.appendChild(e)})}),onRenderContinue:function(e){e()},cancel:function(){e=!0}}}},{key:"setPageLabel",value:function(e){this.pageLabel="string"==typeof e?e:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}}]),n}();exports.PDFPageView=PDFPageView;