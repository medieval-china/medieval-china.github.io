"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var opMap,FontInspector=function(){var s,t=!1,a="data-font-name";function p(){var e,t=_createForOfIteratorHelper(document.querySelectorAll("span[".concat(a,"]")));try{for(t.s();!(e=t.n()).done;){e.value.className="debuggerHideText"}}catch(e){t.e(e)}finally{t.f()}}function u(e,t){var n,r=_createForOfIteratorHelper(document.querySelectorAll("span[".concat(a,"=").concat(e,"]")));try{for(r.s();!(n=r.n()).done;){n.value.className=t?"debuggerShowText":"debuggerHideText"}}catch(e){r.e(e)}finally{r.f()}}function n(e){if(e.target.dataset.fontName&&"SPAN"===e.target.tagName.toUpperCase())for(var t=e.target.dataset.fontName,n=document.getElementsByTagName("input"),r=0;r<n.length;++r){var a=n[r];a.dataset.fontName===t&&(a.checked=!a.checked,u(t,a.checked),a.scrollIntoView())}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(e){var t=this.panel,n=document.createElement("button");n.addEventListener("click",p),n.textContent="Refresh",t.appendChild(n),s=document.createElement("div"),t.appendChild(s)},cleanup:function(){s.textContent=""},enabled:!1,get active(){return t},set active(e){(t=e)?(document.body.addEventListener("click",n,!0),p()):(document.body.removeEventListener("click",n,!0),function(){var e,t=_createForOfIteratorHelper(document.querySelectorAll("span[".concat(a,"]")));try{for(t.s();!(e=t.n()).done;)e.value.className=""}catch(e){t.e(e)}finally{t.f()}}())},fontAdded:function(t,e){var n=this;var r=function(e,t){for(var n=document.createElement("table"),r=0;r<t.length;r++){var a=document.createElement("tr"),o=document.createElement("td");o.textContent=t[r],a.appendChild(o);var i=document.createElement("td");i.textContent=e[t[r]].toString(),a.appendChild(i),n.appendChild(a)}return n}(t,["name","type"]),a=t.loadedName,o=document.createElement("div"),i=document.createElement("span");i.textContent=a;var l=document.createElement("a");e?(e=/url\(['"]?([^)"']+)/.exec(e),l.href=e[1]):t.data&&(l.href=URL.createObjectURL(new Blob([t.data],{type:t.mimeType}))),l.textContent="Download";var d=document.createElement("a");d.href="",d.textContent="Log",d.addEventListener("click",function(e){e.preventDefault(),console.log(t)});var c=document.createElement("input");c.setAttribute("type","checkbox"),c.dataset.fontName=a,c.addEventListener("click",function(){u(a,c.checked)}),o.appendChild(c),o.appendChild(i),o.appendChild(document.createTextNode(" ")),o.appendChild(l),o.appendChild(document.createTextNode(" ")),o.appendChild(d),o.appendChild(r),s.appendChild(o),setTimeout(function(){n.active&&p()},2e3)}}}(),StepperManager=function(){var i=[],o=null,r=null,l=null,d=Object.create(null);return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(e){var t=this;for(var n in r=document.createElement("div"),(l=document.createElement("select")).addEventListener("change",function(e){t.selectStepper(this.value)}),r.appendChild(l),o=document.createElement("div"),this.panel.appendChild(r),this.panel.appendChild(o),sessionStorage.getItem("pdfjsBreakPoints")&&(d=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))),opMap=Object.create(null),e.OPS)opMap[e.OPS[n]]=n},cleanup:function(){l.textContent="",o.textContent="",i=[]},enabled:!1,active:!1,create:function(e){var t=document.createElement("div");t.id="stepper"+e,t.hidden=!0,t.className="stepper",o.appendChild(t);var n=document.createElement("option");n.textContent="Page "+(e+1),n.value=e,l.appendChild(n);var r=d[e]||[],a=new Stepper(t,e,r);return i.push(a),1===i.length&&this.selectStepper(e,!1),a},selectStepper:function(e,t){var n;for(e|=0,t&&this.manager.selectPanel(this),n=0;n<i.length;++n){var r=i[n];r.panel.hidden=r.pageIndex!==e}var a=l.options;for(n=0;n<a.length;++n){var o=a[n];o.selected=(0|o.value)===e}},saveBreakPoints:function(e,t){d[e]=t,sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(d))}}}(),Stepper=function(){function b(e,t){var n=document.createElement(e);return t&&(n.textContent=t),n}function C(e){if("string"==typeof e){return e.length<=75?e:e.substring(0,75)+"..."}if("object"!==_typeof(e)||null===e)return e;if("length"in e){var t,n,r=[];for(t=0,n=Math.min(10,e.length);t<n;t++)r.push(C(e[t]));return t<e.length&&r.push("..."),r}var a={};for(var o in e)a[o]=C(e[o]);return a}function e(e,t,n){this.panel=e,this.breakPoint=0,this.nextBreakPoint=null,this.pageIndex=t,this.breakPoints=n,this.currentIdx=-1,this.operatorListIdx=0}return e.prototype={init:function(e){var t=this.panel,n=b("div","c=continue, s=step"),r=b("table");n.appendChild(r),r.cellSpacing=0;var a=b("tr");r.appendChild(a),a.appendChild(b("th","Break")),a.appendChild(b("th","Idx")),a.appendChild(b("th","fn")),a.appendChild(b("th","args")),t.appendChild(n),this.table=r,this.updateOperatorList(e)},updateOperatorList:function(e){var t=this;function n(){var e=+this.dataset.idx;this.checked?t.breakPoints.push(e):t.breakPoints.splice(t.breakPoints.indexOf(e),1),StepperManager.saveBreakPoints(t.pageIndex,t.breakPoints)}if(!(15e3<this.operatorListIdx)){for(var r=document.createDocumentFragment(),a=Math.min(15e3,e.fnArray.length),o=this.operatorListIdx;o<a;o++){var i=b("tr");i.className="line",i.dataset.idx=o,r.appendChild(i);var l=this.breakPoints.includes(o),d=e.argsArray[o]||[],c=b("td"),s=b("input");s.type="checkbox",s.className="points",s.checked=l,s.dataset.idx=o,s.onclick=n,c.appendChild(s),i.appendChild(c),i.appendChild(b("td",o.toString()));var p=opMap[e.fnArray[o]],u=d;if("showText"===p){for(var h=d[0],f=[],m=[],v=0;v<h.length;v++){var g=h[v];"object"===_typeof(g)&&null!==g?m.push(g.fontChar):(0<m.length&&(f.push(m.join("")),m=[]),f.push(g))}0<m.length&&f.push(m.join("")),u=[f]}i.appendChild(b("td",p)),i.appendChild(b("td",JSON.stringify(C(u))))}if(a<e.fnArray.length){var y=b("td","...");y.colspan=4,r.appendChild(y)}this.operatorListIdx=e.fnArray.length,this.table.appendChild(r)}},getNextBreakPoint:function(){this.breakPoints.sort(function(e,t){return e-t});for(var e=0;e<this.breakPoints.length;e++)if(this.breakPoints[e]>this.currentIdx)return this.breakPoints[e];return null},breakIt:function(e,r){StepperManager.selectStepper(this.pageIndex,!0);var a=this,o=document;a.currentIdx=e;o.addEventListener("keydown",function e(t){switch(t.keyCode){case 83:o.removeEventListener("keydown",e),a.nextBreakPoint=a.currentIdx+1,a.goTo(-1),r();break;case 67:o.removeEventListener("keydown",e);var n=a.getNextBreakPoint();a.nextBreakPoint=n,a.goTo(-1),r()}}),a.goTo(e)},goTo:function(e){for(var t=this.panel.getElementsByClassName("line"),n=0,r=t.length;n<r;++n){var a=t[n];(0|a.dataset.idx)===e?(a.style.backgroundColor="rgb(251,250,207)",a.scrollIntoView()):a.style.backgroundColor=null}}},e}(),Stats=function(){var c=[];function s(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)}return{id:"Stats",name:"Stats",panel:null,manager:null,init:function(e){},enabled:!1,active:!1,add:function(e,t){if(t){var n=function(e){for(var t=0,n=c.length;t<n;++t)if(c[t].pageNumber===e)return t;return!1}(e);if(!1!==n){var r=c[n];this.panel.removeChild(r.div),c.splice(n,1)}var a=document.createElement("div");a.className="stats";var o=document.createElement("div");o.className="title",o.textContent="Page: "+e;var i=document.createElement("div");i.textContent=t.toString(),a.appendChild(o),a.appendChild(i),c.push({pageNumber:e,div:a}),c.sort(function(e,t){return e.pageNumber-t.pageNumber}),s(this.panel);for(var l=0,d=c.length;l<d;++l)this.panel.appendChild(c[l].div)}},cleanup:function(){c=[],s(this.panel)}}}();window.PDFBug=function(){var p=[],a=null;return{tools:[FontInspector,StepperManager,Stats],enable:function(a){var e=!1,o=this.tools;1===a.length&&"all"===a[0]&&(e=!0);for(var t=0;t<o.length;++t){var n=o[t];(e||a.includes(n.id))&&(n.enabled=!0)}e||o.sort(function(e,t){var n=a.indexOf(e.id);n=n<0?o.length:n;var r=a.indexOf(t.id);return n-(r=r<0?o.length:r)})},init:function(e,t){var n=document.createElement("div");n.id="PDFBug";var r=document.createElement("div");r.setAttribute("class","controls"),n.appendChild(r);var a=document.createElement("div");a.setAttribute("class","panels"),n.appendChild(a),t.appendChild(n),t.style.right="300px";for(var o=this.tools,i=this,l=0;l<o.length;++l){var d=o[l],c=document.createElement("div"),s=document.createElement("button");s.textContent=d.name,s.addEventListener("click",function(t){return function(e){e.preventDefault(),i.selectPanel(t)}}(l)),r.appendChild(s),a.appendChild(c),d.panel=c,d.manager=this,d.enabled?d.init(e):c.textContent=d.name+' is disabled. To enable add  "'+d.id+'" to the pdfBug parameter and refresh (separate multiple by commas).',p.push(s)}this.selectPanel(0)},cleanup:function(){for(var e=0,t=this.tools.length;e<t;e++)this.tools[e].enabled&&this.tools[e].cleanup()},selectPanel:function(e){if("number"!=typeof e&&(e=this.tools.indexOf(e)),e!==a){a=e;for(var t=this.tools,n=0;n<t.length;++n){var r=n===e;p[n].classList.toggle("active",r),t[n].active=r,t[n].panel.hidden=!r}}}}}();