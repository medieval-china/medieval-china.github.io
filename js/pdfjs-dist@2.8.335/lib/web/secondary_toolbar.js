"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0===o)return("string"===t?String:Number)(e);var n=o.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.SecondaryToolbar=void 0;var _ui_utils=require("./ui_utils.js"),_pdf_cursor_tools=require("./pdf_cursor_tools.js"),_pdf_single_page_viewer=require("./pdf_single_page_viewer.js"),SecondaryToolbar=function(){function r(e,t,o){var n=this;_classCallCheck(this,r),this.toolbar=e.toolbar,this.toggleButton=e.toggleButton,this.toolbarButtonContainer=e.toolbarButtonContainer,this.buttons=[{element:e.presentationModeButton,eventName:"presentationmode",close:!0},{element:e.openFileButton,eventName:"openfile",close:!0},{element:e.printButton,eventName:"print",close:!0},{element:e.downloadButton,eventName:"download",close:!0},{element:e.viewBookmarkButton,eventName:null,close:!0},{element:e.firstPageButton,eventName:"firstpage",close:!0},{element:e.lastPageButton,eventName:"lastpage",close:!0},{element:e.pageRotateCwButton,eventName:"rotatecw",close:!1},{element:e.pageRotateCcwButton,eventName:"rotateccw",close:!1},{element:e.cursorSelectToolButton,eventName:"switchcursortool",eventDetails:{tool:_pdf_cursor_tools.CursorTool.SELECT},close:!0},{element:e.cursorHandToolButton,eventName:"switchcursortool",eventDetails:{tool:_pdf_cursor_tools.CursorTool.HAND},close:!0},{element:e.scrollVerticalButton,eventName:"switchscrollmode",eventDetails:{mode:_ui_utils.ScrollMode.VERTICAL},close:!0},{element:e.scrollHorizontalButton,eventName:"switchscrollmode",eventDetails:{mode:_ui_utils.ScrollMode.HORIZONTAL},close:!0},{element:e.scrollWrappedButton,eventName:"switchscrollmode",eventDetails:{mode:_ui_utils.ScrollMode.WRAPPED},close:!0},{element:e.spreadNoneButton,eventName:"switchspreadmode",eventDetails:{mode:_ui_utils.SpreadMode.NONE},close:!0},{element:e.spreadOddButton,eventName:"switchspreadmode",eventDetails:{mode:_ui_utils.SpreadMode.ODD},close:!0},{element:e.spreadEvenButton,eventName:"switchspreadmode",eventDetails:{mode:_ui_utils.SpreadMode.EVEN},close:!0},{element:e.documentPropertiesButton,eventName:"documentproperties",close:!0}],this.items={firstPage:e.firstPageButton,lastPage:e.lastPageButton,pageRotateCw:e.pageRotateCwButton,pageRotateCcw:e.pageRotateCcwButton},this.mainContainer=t,this.eventBus=o,this.opened=!1,this.containerHeight=null,this.previousContainerHeight=null,this.reset(),this._bindClickListeners(),this._bindCursorToolsListener(e),this._bindScrollModeListener(e),this._bindSpreadModeListener(e),this.eventBus._on("resize",this._setMaxHeight.bind(this)),this.eventBus._on("baseviewerinit",function(e){e.source instanceof _pdf_single_page_viewer.PDFSinglePageViewer?n.toolbarButtonContainer.classList.add("hiddenScrollModeButtons","hiddenSpreadModeButtons"):n.toolbarButtonContainer.classList.remove("hiddenScrollModeButtons","hiddenSpreadModeButtons")})}return _createClass(r,[{key:"isOpen",get:function(){return this.opened}},{key:"setPageNumber",value:function(e){this.pageNumber=e,this._updateUIState()}},{key:"setPagesCount",value:function(e){this.pagesCount=e,this._updateUIState()}},{key:"reset",value:function(){this.pageNumber=0,this.pagesCount=0,this._updateUIState(),this.eventBus.dispatch("secondarytoolbarreset",{source:this})}},{key:"_updateUIState",value:function(){this.items.firstPage.disabled=this.pageNumber<=1,this.items.lastPage.disabled=this.pageNumber>=this.pagesCount,this.items.pageRotateCw.disabled=0===this.pagesCount,this.items.pageRotateCcw.disabled=0===this.pagesCount}},{key:"_bindClickListeners",value:function(){var s=this;this.toggleButton.addEventListener("click",this.toggle.bind(this));var o,t=_createForOfIteratorHelper(this.buttons);try{var e=function(){var e=o.value,t=e.element,n=e.eventName,r=e.close,i=e.eventDetails;t.addEventListener("click",function(e){if(null!==n){var t={source:s};for(var o in i)t[o]=i[o];s.eventBus.dispatch(n,t)}r&&s.close()})};for(t.s();!(o=t.n()).done;)e()}catch(e){t.e(e)}finally{t.f()}}},{key:"_bindCursorToolsListener",value:function(o){this.eventBus._on("cursortoolchanged",function(e){var t=e.tool;o.cursorSelectToolButton.classList.toggle("toggled",t===_pdf_cursor_tools.CursorTool.SELECT),o.cursorHandToolButton.classList.toggle("toggled",t===_pdf_cursor_tools.CursorTool.HAND)})}},{key:"_bindScrollModeListener",value:function(n){var t=this;function o(e){var t=e.mode;n.scrollVerticalButton.classList.toggle("toggled",t===_ui_utils.ScrollMode.VERTICAL),n.scrollHorizontalButton.classList.toggle("toggled",t===_ui_utils.ScrollMode.HORIZONTAL),n.scrollWrappedButton.classList.toggle("toggled",t===_ui_utils.ScrollMode.WRAPPED);var o=t===_ui_utils.ScrollMode.HORIZONTAL;n.spreadNoneButton.disabled=o,n.spreadOddButton.disabled=o,n.spreadEvenButton.disabled=o}this.eventBus._on("scrollmodechanged",o),this.eventBus._on("secondarytoolbarreset",function(e){e.source===t&&o({mode:_ui_utils.ScrollMode.VERTICAL})})}},{key:"_bindSpreadModeListener",value:function(o){var t=this;function n(e){var t=e.mode;o.spreadNoneButton.classList.toggle("toggled",t===_ui_utils.SpreadMode.NONE),o.spreadOddButton.classList.toggle("toggled",t===_ui_utils.SpreadMode.ODD),o.spreadEvenButton.classList.toggle("toggled",t===_ui_utils.SpreadMode.EVEN)}this.eventBus._on("spreadmodechanged",n),this.eventBus._on("secondarytoolbarreset",function(e){e.source===t&&n({mode:_ui_utils.SpreadMode.NONE})})}},{key:"open",value:function(){this.opened||(this.opened=!0,this._setMaxHeight(),this.toggleButton.classList.add("toggled"),this.toggleButton.setAttribute("aria-expanded","true"),this.toolbar.classList.remove("hidden"))}},{key:"close",value:function(){this.opened&&(this.opened=!1,this.toolbar.classList.add("hidden"),this.toggleButton.classList.remove("toggled"),this.toggleButton.setAttribute("aria-expanded","false"))}},{key:"toggle",value:function(){this.opened?this.close():this.open()}},{key:"_setMaxHeight",value:function(){this.opened&&(this.containerHeight=this.mainContainer.clientHeight,this.containerHeight!==this.previousContainerHeight&&(this.toolbarButtonContainer.style.maxHeight="".concat(this.containerHeight-_ui_utils.SCROLLBAR_PADDING,"px"),this.previousContainerHeight=this.containerHeight))}}]),r}();exports.SecondaryToolbar=SecondaryToolbar;