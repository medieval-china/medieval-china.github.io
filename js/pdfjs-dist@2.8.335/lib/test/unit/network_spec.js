"use strict";var _util=require("../../shared/util.js"),_network=require("../../display/network.js");describe("network",function(){var g=new URL("../pdfs/tracemonkey.pdf",window.location).href,h=1016315;it("read without stream and range",function(t){var n,a,e=new _network.PDFNetworkStream({url:g,rangeChunkSize:65536,disableStream:!0,disableRange:!0}).getFullReader(),r=e.headersReady.then(function(){n=e.isStreamingSupported,a=e.isRangeSupported}),u=0,o=0;Promise.all([function t(){return e.read().then(function(e){if(!e.done)return o++,u+=e.value.byteLength,t()})}(),r]).then(function(e){expect(u).toEqual(h),expect(o).toEqual(1),expect(n).toEqual(!1),expect(a).toEqual(!1),t()}).catch(function(e){t.fail(e)})}),it("read custom ranges",function(t){var e,n,a,r=32768,u=new _network.PDFNetworkStream({url:g,length:h,rangeChunkSize:r,disableStream:!0,disableRange:!1}),o=u.getFullReader(),i=o.headersReady.then(function(){e=o.isStreamingSupported,n=o.isRangeSupported,o.cancel(new _util.AbortException("Don't need fullReader.")),a=!0}),l=507,c=u.getRangeReader(h-l-r,h-l),d=u.getRangeReader(h-l,h),s={value:0},f={value:0},p=function t(n,a){return n.read().then(function(e){if(!e.done)return a.value+=e.value.byteLength,t(n,a)})};Promise.all([p(c,s),p(d,f),i]).then(function(){expect(s.value).toEqual(r),expect(f.value).toEqual(l),expect(e).toEqual(!1),expect(n).toEqual(!0),expect(a).toEqual(!0),t()}).catch(function(e){t.fail(e)})})});