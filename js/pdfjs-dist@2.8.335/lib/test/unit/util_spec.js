"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var _util=require("../../shared/util.js");describe("util",function(){describe("bytesToString",function(){it("handles non-array arguments",function(){expect(function(){(0,_util.bytesToString)(null)}).toThrow(new Error("Invalid argument for bytesToString"))}),it("handles array arguments with a length not exceeding the maximum",function(){expect((0,_util.bytesToString)(new Uint8Array([]))).toEqual(""),expect((0,_util.bytesToString)(new Uint8Array([102,111,111]))).toEqual("foo")}),it("handles array arguments with a length exceeding the maximum",function(){for(var t=new Uint8Array(1e4),e=0;e<1e4;e++)t[e]="a".charCodeAt(0);var i=Array(10001).join("a");expect((0,_util.bytesToString)(t)).toEqual(i)})}),describe("isArrayBuffer",function(){it("handles array buffer values",function(){expect((0,_util.isArrayBuffer)(new ArrayBuffer(0))).toEqual(!0),expect((0,_util.isArrayBuffer)(new Uint8Array(0))).toEqual(!0)}),it("handles non-array buffer values",function(){expect((0,_util.isArrayBuffer)("true")).toEqual(!1),expect((0,_util.isArrayBuffer)(1)).toEqual(!1),expect((0,_util.isArrayBuffer)(null)).toEqual(!1),expect((0,_util.isArrayBuffer)(void 0)).toEqual(!1)})}),describe("isBool",function(){it("handles boolean values",function(){expect((0,_util.isBool)(!0)).toEqual(!0),expect((0,_util.isBool)(!1)).toEqual(!0)}),it("handles non-boolean values",function(){expect((0,_util.isBool)("true")).toEqual(!1),expect((0,_util.isBool)("false")).toEqual(!1),expect((0,_util.isBool)(1)).toEqual(!1),expect((0,_util.isBool)(0)).toEqual(!1),expect((0,_util.isBool)(null)).toEqual(!1),expect((0,_util.isBool)(void 0)).toEqual(!1)})}),describe("isNum",function(){it("handles numeric values",function(){expect((0,_util.isNum)(1)).toEqual(!0),expect((0,_util.isNum)(0)).toEqual(!0),expect((0,_util.isNum)(-1)).toEqual(!0),expect((0,_util.isNum)(1e18)).toEqual(!0),expect((0,_util.isNum)(12.34)).toEqual(!0)}),it("handles non-numeric values",function(){expect((0,_util.isNum)("true")).toEqual(!1),expect((0,_util.isNum)(!0)).toEqual(!1),expect((0,_util.isNum)(null)).toEqual(!1),expect((0,_util.isNum)(void 0)).toEqual(!1)})}),describe("isString",function(){it("handles string values",function(){expect((0,_util.isString)("foo")).toEqual(!0),expect((0,_util.isString)("")).toEqual(!0)}),it("handles non-string values",function(){expect((0,_util.isString)(!0)).toEqual(!1),expect((0,_util.isString)(1)).toEqual(!1),expect((0,_util.isString)(null)).toEqual(!1),expect((0,_util.isString)(void 0)).toEqual(!1)})}),describe("string32",function(){it("converts unsigned 32-bit integers to strings",function(){expect((0,_util.string32)(1953658213)).toEqual("true"),expect((0,_util.string32)(1954115633)).toEqual("typ1"),expect((0,_util.string32)(1330926671)).toEqual("OTTO")})}),describe("stringToBytes",function(){it("handles non-string arguments",function(){expect(function(){(0,_util.stringToBytes)(null)}).toThrow(new Error("Invalid argument for stringToBytes"))}),it("handles string arguments",function(){expect((0,_util.stringToBytes)("")).toEqual(new Uint8Array([])),expect((0,_util.stringToBytes)("foo")).toEqual(new Uint8Array([102,111,111]))})}),describe("stringToPDFString",function(){it("handles ISO Latin 1 strings",function(){expect((0,_util.stringToPDFString)("string")).toEqual("“string”")}),it("handles UTF-16 big-endian strings",function(){expect((0,_util.stringToPDFString)("þÿ\0s\0t\0r\0i\0n\0g")).toEqual("string")}),it("handles UTF-16 little-endian strings",function(){expect((0,_util.stringToPDFString)("ÿþs\0t\0r\0i\0n\0g\0")).toEqual("string")}),it("handles empty strings",function(){expect((0,_util.stringToPDFString)("")).toEqual("");expect((0,_util.stringToPDFString)("þÿ")).toEqual("");expect((0,_util.stringToPDFString)("ÿþ")).toEqual("")})}),describe("removeNullCharacters",function(){it("should not modify string without null characters",function(){expect((0,_util.removeNullCharacters)("string without null chars")).toEqual("string without null chars")}),it("should modify string with null characters",function(){expect((0,_util.removeNullCharacters)("string\0With\0Null\0Chars")).toEqual("stringWithNullChars")})}),describe("ReadableStream",function(){it("should return an Object",function(){var t=new ReadableStream;expect(_typeof(t)).toEqual("object")}),it("should have property getReader",function(){var t=new ReadableStream;expect(_typeof(t.getReader)).toEqual("function")})}),describe("URL",function(){it("should return an Object",function(){var t=new URL("https://example.com");expect(_typeof(t)).toEqual("object")}),it("should have property `href`",function(){var t=new URL("https://example.com");expect(_typeof(t.href)).toEqual("string")})}),describe("isSameOrigin",function(){it("handles invalid base URLs",function(){expect((0,_util.isSameOrigin)("/foo","/bar")).toEqual(!1),expect((0,_util.isSameOrigin)("blob:foo","/bar")).toEqual(!1)}),it("correctly checks if the origin of both URLs matches",function(){expect((0,_util.isSameOrigin)("https://www.mozilla.org/foo","https://www.mozilla.org/bar")).toEqual(!0),expect((0,_util.isSameOrigin)("https://www.mozilla.org/foo","https://www.example.com/bar")).toEqual(!1)})}),describe("createValidAbsoluteUrl",function(){it("handles invalid URLs",function(){expect((0,_util.createValidAbsoluteUrl)(void 0,void 0)).toEqual(null),expect((0,_util.createValidAbsoluteUrl)(null,null)).toEqual(null),expect((0,_util.createValidAbsoluteUrl)("/foo","/bar")).toEqual(null)}),it("handles URLs that do not use an allowed protocol",function(){expect((0,_util.createValidAbsoluteUrl)("magnet:?foo",null)).toEqual(null)}),it("correctly creates a valid URL for allowed protocols",function(){expect((0,_util.createValidAbsoluteUrl)("http://www.mozilla.org/foo",null)).toEqual(new URL("http://www.mozilla.org/foo")),expect((0,_util.createValidAbsoluteUrl)("/foo","http://www.mozilla.org")).toEqual(new URL("http://www.mozilla.org/foo")),expect((0,_util.createValidAbsoluteUrl)("https://www.mozilla.org/foo",null)).toEqual(new URL("https://www.mozilla.org/foo")),expect((0,_util.createValidAbsoluteUrl)("/foo","https://www.mozilla.org")).toEqual(new URL("https://www.mozilla.org/foo")),expect((0,_util.createValidAbsoluteUrl)("ftp://www.mozilla.org/foo",null)).toEqual(new URL("ftp://www.mozilla.org/foo")),expect((0,_util.createValidAbsoluteUrl)("/foo","ftp://www.mozilla.org")).toEqual(new URL("ftp://www.mozilla.org/foo")),expect((0,_util.createValidAbsoluteUrl)("mailto:foo@bar.baz",null)).toEqual(new URL("mailto:foo@bar.baz")),expect((0,_util.createValidAbsoluteUrl)("/foo","mailto:foo@bar.baz")).toEqual(null),expect((0,_util.createValidAbsoluteUrl)("tel:+0123456789",null)).toEqual(new URL("tel:+0123456789")),expect((0,_util.createValidAbsoluteUrl)("/foo","tel:0123456789")).toEqual(null)})}),describe("createPromiseCapability",function(){it("should resolve with correct data",function(e){var i=(0,_util.createPromiseCapability)();expect(i.settled).toEqual(!1),i.resolve({test:"abc"}),i.promise.then(function(t){expect(i.settled).toEqual(!0),expect(t).toEqual({test:"abc"}),e()},e.fail)}),it("should reject with correct reason",function(e){var i=(0,_util.createPromiseCapability)();expect(i.settled).toEqual(!1),i.reject(new Error("reason")),i.promise.then(e.fail,function(t){expect(i.settled).toEqual(!0),expect(t instanceof Error).toEqual(!0),expect(t.message).toEqual("reason"),e()})})}),describe("escapeString",function(){it("should escape (, ), \\n, \\r, and \\",function(){expect((0,_util.escapeString)("((a\\a))\n(b(b\\b)\rb)")).toEqual("\\(\\(a\\\\a\\)\\)\\n\\(b\\(b\\\\b\\)\\rb\\)")})}),describe("getModificationDate",function(){it("should get a correctly formatted date",function(){var t=new Date(Date.UTC(3141,5,9,2,6,53));expect((0,_util.getModificationDate)(t)).toEqual("31410609020653")})}),describe("isAscii",function(){it("handles ascii/non-ascii strings",function(){expect((0,_util.isAscii)("hello world")).toEqual(!0),expect((0,_util.isAscii)("こんにちは世界の")).toEqual(!1),expect((0,_util.isAscii)("hello world in Japanese is こんにちは世界の")).toEqual(!1)})}),describe("stringToUTF16BEString",function(){it("should encode a string in UTF16BE with a BOM",function(){expect((0,_util.stringToUTF16BEString)("hello world")).toEqual("þÿ\0h\0e\0l\0l\0o\0 \0w\0o\0r\0l\0d"),expect((0,_util.stringToUTF16BEString)("こんにちは世界の")).toEqual("þÿ0S00k0a0oNuL0n")})})});